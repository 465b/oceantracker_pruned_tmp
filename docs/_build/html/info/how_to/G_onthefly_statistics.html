
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>On-the-fly statistics &#8212; OceanTracker Beta 0.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Run in parallel" href="P_running_cases_in_parallel.html" />
    <link rel="prev" title="plotting tracks" href="F_plotting_tracks.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/ocean_tracker.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=oceantracker&repo=oceantracker&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery.html">Gallery</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../users_guide.html">Users guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installing.html">Installing</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../how_to.html">How to notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running_ocean_tracker.html">Running OceanTracker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parameter_ref/parameter_ref_toc.html">Parameter details</a></li>
<li class="toctree-l2"><a class="reference internal" href="D_output_files.html">Output files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../change_log.html">Change log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../future_dev.html">Future development</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../users_guide.html">Users guide</a><ul>
  <li><a href="../how_to.html">How to notebooks</a><ul>
      <li>Previous: <a href="F_plotting_tracks.html" title="previous chapter">plotting tracks</a></li>
      <li>Next: <a href="P_running_cases_in_parallel.html" title="next chapter">Run in parallel</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="on-the-fly-statistics">
<h1>On-the-fly statistics<a class="headerlink" href="#on-the-fly-statistics" title="Permalink to this heading">¶</a></h1>
<p>[This note-book is in oceantracker/tutorials_how_to/]</p>
<p>Scaling up particle numbers to millions will create large volumes of
particle track data. Storing and analyzing these tracks is slow and
rapidly becomes overwhelming. For example, building a heat map from a
terabyte of particle tracks after a run has completed. Ocean tracker can
build some particle statistics on the fly, without recording any
particle tracks. This results in more manageable data volumes and
analysis.</p>
<p>On-the-fly statistics record particle counts separately for each release
group. It is also possible to subset the counts, ie only count particles
which are stranded by the tide by designating a range of particle status
values to count. Or, only count particles in a given vertical “z” range.
Users can add multiple statistics, all calculated in from the same
particles during the run. Eg. could add a particle statistic for each
status type, for different depth ranges.</p>
<p>Statistics can be read, plotted or animated with OceanTrackers
post-processing code, see below</p>
<p>The available “particle_statistics” classes with their individual
settings are at …. add link</p>
<p>Currently there are two main classes of 2D particle statistics “gridded”
which counts particles inside cells of a regular grid, and “polygon”
which counts particles in a given list of polygons.</p>
<p>The user can add many particle statistics classes, all based on the same
particles. For both types it is possible to only count a subset of these
particles, by setting a min. and/or max status to count, or setting a
min. and/or max. “z”, the vertical location. So could add several
statistics classes, each counting particles in different layers, or
classes to separately count those moving and those on the bottom hoping
to be re-suspended.</p>
<section id="gridded-statistics">
<h2>Gridded statistics<a class="headerlink" href="#gridded-statistics" title="Permalink to this heading">¶</a></h2>
<p>These are heat maps of counts binned into cells of a regular grid. Along
with heat maps of particle counts, users can optionally build a heat
maps of named particle properties, eg. the value decaying particle
property. To ensure the heat map grids are not too large or too coarse,
by default grids are centred on each release group, thus there are
different grid locations for each release group.</p>
</section>
<section id="polygon-statistics">
<h2>Polygon statistics<a class="headerlink" href="#polygon-statistics" title="Permalink to this heading">¶</a></h2>
<p>These particle counts can be used to calculate the connectivity between
each release group and a user given list of “statistics” polygons. Also,
used to estimate the influence of each release group on a particle
property with each given statistics polygon. The statistics polygons are
not the same as those used in a polygon release (they can be if the user
requires it). Polygon statistics show effect of each point or polygon
release, on the given statistics polygons. A special case of a polygon
statistic, is the “residence_time” class, which can be used to calculate
the fraction of particles from each release group remaining within each
statistics polygon at each ‘update_interval’ as one way to estimate
particle residence time for each release group.</p>
</section>
<section id="particle-property-statistics">
<h2>Particle property statistics<a class="headerlink" href="#particle-property-statistics" title="Permalink to this heading">¶</a></h2>
<p>Both types of statistics can also record sums of user designated
particle properties within each given grid cell or statistics polygon,
which originate from each release group. These sums enabling mean values
of designated particle properties within each grid cell or polygon to be
calculated. They can also be used to estimate the relative influence of
each release group on the value of a particle property within each given
grid cell or polygon.</p>
<p>A future version with allow estimating the variance of the designated
property values and particle counts in each grid cell or polygon, for
each release group.</p>
</section>
<section id="gridded-heat-map-example">
<h2>Gridded/Heat map example<a class="headerlink" href="#gridded-heat-map-example" title="Permalink to this heading">¶</a></h2>
<p>The below uses the helper class method to extends the minimal_example to
add</p>
<ul class="simple">
<li><p>Decaying particle property, eg. breakdown of a pollutant</p></li>
<li><p>Gridded time series of particle statistics as heat maps, which also
builds a heat map of the pollutant</p></li>
<li><p>Plot the particle counts and pollutant as animated heatmap.</p></li>
</ul>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gridded Statistics example.py using class helper method</span>
<span class="c1">#------------------------------------------------</span>
<span class="kn">from</span> <span class="nn">oceantracker.main</span> <span class="kn">import</span> <span class="n">OceanTracker</span>

<span class="c1"># make instance of oceantracker to use to set parameters using code, then run</span>
<span class="n">ot</span> <span class="o">=</span> <span class="n">OceanTracker</span><span class="p">()</span>

<span class="c1"># ot.settings method use to set basic settings</span>
<span class="n">ot</span><span class="o">.</span><span class="n">settings</span><span class="p">(</span><span class="n">output_file_base</span><span class="o">=</span><span class="s1">&#39;heat_map_example&#39;</span><span class="p">,</span> <span class="c1"># name used as base for output files</span>
            <span class="n">root_output_dir</span><span class="o">=</span><span class="s1">&#39;output&#39;</span><span class="p">,</span>             <span class="c1">#  output is put in dir   &#39;root_output_dir&#39;\\&#39;output_file_base&#39;</span>
            <span class="n">time_step</span><span class="o">=</span> <span class="mf">600.</span><span class="p">,</span> <span class="c1">#  10 min time step as seconds</span>
            <span class="n">write_tracks</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># particle tracks not needed for on fly</span>
            <span class="p">)</span>
<span class="c1"># ot.set_class, sets parameters for a named class</span>
<span class="n">ot</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="s1">&#39;reader&#39;</span><span class="p">,</span><span class="n">input_dir</span><span class="o">=</span> <span class="s1">&#39;../demos/demo_hindcast&#39;</span><span class="p">,</span>  <span class="c1"># folder to search for hindcast files, sub-dirs will, by default, also be searched</span>
                      <span class="n">file_mask</span><span class="o">=</span>  <span class="s1">&#39;demoHindcastSchism*.nc&#39;</span><span class="p">)</span>  <span class="c1"># hindcast file mask</span>

<span class="c1"># add one release locations</span>
<span class="n">ot</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="s1">&#39;release_groups&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;my_release_point&#39;</span><span class="p">,</span> <span class="c1"># user must provide a name for group first</span>
                        <span class="n">points</span><span class="o">=</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1599000</span><span class="p">,</span> <span class="mi">5486200</span><span class="p">]],</span>       <span class="c1"># ust be 1 by N list pairs of release locations</span>
                        <span class="n">release_interval</span><span class="o">=</span> <span class="mi">900</span><span class="p">,</span>           <span class="c1"># seconds between releasing particles</span>
                        <span class="n">pulse_size</span><span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>                   <span class="c1"># number of particles released each release_interval</span>
            <span class="p">)</span>

<span class="c1"># add a decaying particle property</span>
<span class="c1"># add and Age decay particle property, with exponential decay based on age, with time scale 1 hour</span>
<span class="n">ot</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="s1">&#39;particle_properties&#39;</span><span class="p">,</span> <span class="c1"># add a new property to particle_properties role</span>
            <span class="n">name</span> <span class="o">=</span><span class="s1">&#39;a_pollutant&#39;</span><span class="p">,</span> <span class="c1"># must have a user given name</span>
            <span class="n">class_name</span><span class="o">=</span><span class="s1">&#39;oceantracker.particle_properties.age_decay.AgeDecay&#39;</span><span class="p">,</span> <span class="c1">#  class_role is resuspension</span>
            <span class="n">initial_value</span><span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
            <span class="n">decay_time_scale</span> <span class="o">=</span> <span class="mf">3600.</span><span class="p">)</span> <span class="c1"># time scale of age decay ie decays initial_value* exp(-age/decay_time_scale)</span>

<span class="c1"># add a gridded particle statistic</span>
<span class="n">ot</span><span class="o">.</span><span class="n">add_class</span><span class="p">(</span><span class="s1">&#39;particle_statistics&#39;</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;my_heatmap&#39;</span><span class="p">,</span>
                <span class="n">class_name</span><span class="o">=</span> <span class="s1">&#39;oceantracker.particle_statistics.gridded_statistics.GriddedStats2D_timeBased&#39;</span><span class="p">,</span>
                <span class="c1"># the below settings are optional</span>
                <span class="n">update_interval</span> <span class="o">=</span> <span class="mi">900</span><span class="p">,</span> <span class="c1"># time interval in sec, between doing particle statists counts</span>
                <span class="n">particle_property_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a_pollutant&#39;</span><span class="p">],</span> <span class="c1"># request a heat map for the decaying part. prop. added above</span>
                <span class="n">status_min</span> <span class="o">=</span><span class="s1">&#39;moving&#39;</span><span class="p">,</span> <span class="c1"># only count the particles which are moving</span>
                <span class="n">z_mi</span> <span class="o">=-</span><span class="mf">2.</span><span class="p">,</span>  <span class="c1"># only count particles at locations above z=-2m</span>
                <span class="n">grid_size</span><span class="o">=</span> <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">121</span><span class="p">]</span>  <span class="c1"># number of east and north cells in the heat map</span>
                <span class="p">)</span>


<span class="c1"># run oceantracker</span>
<span class="n">case_info_file_name</span> <span class="o">=</span> <span class="n">ot</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<pre class="literal-block">main: --------------------------------------------------------------------------
main: OceanTracker- preliminary setup
main:      Python version: 3.10.9 | packaged by conda-forge | (main, Jan 11 2023, 15:15:40) [MSC v.1916 64 bit (AMD64)]
main:   - found hydro-model files of type SCHISIM
main:       -  sorted hyrdo-model files in time order,        0.008 sec
main:     &gt;&gt;&gt; Note: output is in dir= e:H_Local_driveParticleTrackingoceantrackertutorials_how_tooutputheat_map_example
main:     &gt;&gt;&gt; Note: to help with debugging, parameters as given by user  are in &quot;heat_map_example_raw_user_params.json&quot;
C000: --------------------------------------------------------------------------
C000: Starting case number   0,  heat_map_example at 2023-06-21T17:05:04.209221
C000: --------------------------------------------------------------------------
C000:       -  built node to triangles map,   0.000 sec
C000:       -  built triangle adjacency matrix,       0.000 sec
C000:       -  found boundary triangles,      0.000 sec
C000:       -  built domain and island outlines,      0.630 sec
C000:       -  calculated triangle areas,     0.000 sec
C000:   Finished grid setup
C000:       -  set up release_groups,         0.000 sec
C000:       -  built barycentric-transform matrix,    0.000 sec
C000:       -  initial set up of core classes,        0.021 sec
C000:       -  final set up of core classes,          0.001 sec
C000:       -  created particle properties derived from fields,       0.004 sec
C000: &gt;&gt;&gt; Warning: &quot;z_mi&quot; is not recognised, ignoring this param.
C000:       in:  &gt;&gt;&gt; adding_class type &gt;&gt; &quot;particle_statistics&quot;  (name=  &quot;my_heatmap&quot; instance # 0),  making class type particle_statistics  &gt;&gt; &quot;z_mi&quot;
C000:       Hint: Closest matches to &quot;z_mi&quot; = ['z_min', 'z_max', 'status_min'] ??
C000: &gt;&gt;&gt; Note: No open boundaries requested, as run_params[&quot;open_boundary_type&quot;] = 0
C000:       Hint: Requires list of open boundary nodes not in hydro model, eg for Schism this can be read from hgrid file to named in reader params and run_params[&quot;open_boundary_type&quot;] = 1
C000: --------------------------------------------------------------------------
C000:   - Starting heat_map_example,  duration: 0 days 23 hrs 0 min 0 sec
C000:       -  Initialized Solver Class,      0.000 sec
C000: 00% step 0000:H0000b00-01 Day +00 00:00 2017-01-01 00:30:00: Rel.:   1,000: Active:01000 M:01000 S:00000  B:00000 D:000 O:00 N:000 Buffer:1000 -  0% step time = 299.6 ms
C000:   - Reading-file-00  demoHindcastSchism3D.nc, steps in file  24, steps  available 000:023, reading  24 of 48 steps,  for hydo-model time steps 00:23,  from file offsets 00:23,  into ring buffer offsets 000:023
C000:       -  read  24 time steps in  0.0 sec
C000:   - opening tracks output to : heat_map_example_tracks_compact.nc
C000: 04% step 0006:H0001b01-02 Day +00 01:00 2017-01-01 01:30:00: Rel.:   5,000: Active:05000 M:04740 S:00000  B:00260 D:000 O:00 N:000 Buffer:5000 -  1% step time =  1.5 ms
C000: 09% step 0012:H0002b02-03 Day +00 02:00 2017-01-01 02:30:00: Rel.:   9,000: Active:09000 M:08528 S:00003  B:00469 D:000 O:00 N:000 Buffer:9000 -  2% step time =  1.5 ms
C000: 13% step 0018:H0003b03-04 Day +00 03:00 2017-01-01 03:30:00: Rel.:  13,000: Active:13000 M:12281 S:00142  B:00577 D:000 O:00 N:000 Buffer:13000 -  3% step time =  1.6 ms
C000: 17% step 0024:H0004b04-05 Day +00 04:00 2017-01-01 04:30:00: Rel.:  17,000: Active:17000 M:16196 S:00142  B:00662 D:000 O:00 N:000 Buffer:17000 -  3% step time =  1.5 ms
C000: 22% step 0030:H0005b05-06 Day +00 05:00 2017-01-01 05:30:00: Rel.:  21,000: Active:21000 M:20141 S:00142  B:00717 D:000 O:00 N:000 Buffer:21000 -  4% step time =  1.6 ms
C000: 26% step 0036:H0006b06-07 Day +00 06:00 2017-01-01 06:30:00: Rel.:  25,000: Active:25000 M:24054 S:00142  B:00804 D:000 O:00 N:000 Buffer:25000 -  5% step time =  1.7 ms
C000: 30% step 0042:H0007b07-08 Day +00 07:00 2017-01-01 07:30:00: Rel.:  29,000: Active:29000 M:27693 S:00142  B:01165 D:000 O:00 N:000 Buffer:29000 -  6% step time =  1.6 ms
C000: 35% step 0048:H0008b08-09 Day +00 08:00 2017-01-01 08:30:00: Rel.:  33,000: Active:33000 M:31532 S:00142  B:01326 D:000 O:00 N:000 Buffer:33000 -  7% step time =  1.7 ms
C000: 39% step 0054:H0009b09-10 Day +00 09:00 2017-01-01 09:30:00: Rel.:  37,000: Active:37000 M:35474 S:00003  B:01523 D:000 O:00 N:000 Buffer:37000 -  7% step time =  1.8 ms
C000: 43% step 0060:H0010b10-11 Day +00 10:00 2017-01-01 10:30:00: Rel.:  41,000: Active:41000 M:39211 S:00000  B:01789 D:000 O:00 N:000 Buffer:41000 -  8% step time =  1.8 ms
C000: 48% step 0066:H0011b11-12 Day +00 11:00 2017-01-01 11:30:00: Rel.:  45,000: Active:45000 M:42964 S:00000  B:02036 D:000 O:00 N:000 Buffer:45000 -  9% step time =  1.8 ms
C000: 52% step 0072:H0012b12-13 Day +00 12:00 2017-01-01 12:30:00: Rel.:  49,000: Active:49000 M:46891 S:00000  B:02109 D:000 O:00 N:000 Buffer:49000 - 10% step time =  1.8 ms
C000: 57% step 0078:H0012b12-13 Day +00 13:00 2017-01-01 13:30:00: Rel.:  53,000: Active:53000 M:50853 S:00000  B:02147 D:000 O:00 N:000 Buffer:53000 - 11% step time =  1.8 ms
C000: 61% step 0084:H0014b14-15 Day +00 14:00 2017-01-01 14:30:00: Rel.:  57,000: Active:57000 M:54491 S:00359  B:02150 D:000 O:00 N:000 Buffer:57000 - 11% step time =  1.8 ms
C000: 65% step 0090:H0015b15-16 Day +00 15:00 2017-01-01 15:30:00: Rel.:  61,000: Active:61000 M:58363 S:00678  B:01959 D:000 O:00 N:000 Buffer:61000 - 12% step time =  1.8 ms
C000: 70% step 0096:H0016b16-17 Day +00 16:00 2017-01-01 16:30:00: Rel.:  65,000: Active:65000 M:62520 S:00678  B:01802 D:000 O:00 N:000 Buffer:65000 - 13% step time =  1.9 ms
C000: 74% step 0102:H0017b17-18 Day +00 17:00 2017-01-01 17:30:00: Rel.:  69,000: Active:69000 M:66407 S:00678  B:01915 D:000 O:00 N:000 Buffer:69000 - 14% step time =  1.9 ms
C000: 78% step 0108:H0018b18-19 Day +00 18:00 2017-01-01 18:30:00: Rel.:  73,000: Active:73000 M:70242 S:00678  B:02080 D:000 O:00 N:000 Buffer:73000 - 15% step time =  1.9 ms
C000: 83% step 0114:H0019b19-20 Day +00 19:00 2017-01-01 19:30:00: Rel.:  77,000: Active:77000 M:73916 S:00678  B:02406 D:000 O:00 N:000 Buffer:77000 - 15% step time =  1.9 ms
C000: 87% step 0120:H0020b20-21 Day +00 20:00 2017-01-01 20:30:00: Rel.:  81,000: Active:81000 M:77515 S:00678  B:02807 D:000 O:00 N:000 Buffer:81000 - 16% step time =  1.9 ms
C000: 91% step 0126:H0021b21-22 Day +00 21:00 2017-01-01 21:30:00: Rel.:  85,000: Active:85000 M:81299 S:00340  B:03361 D:000 O:00 N:000 Buffer:85000 - 17% step time =  1.9 ms
C000: 96% step 0132:H0022b22-23 Day +00 22:00 2017-01-01 22:30:00: Rel.:  89,000: Active:89000 M:85100 S:00000  B:03900 D:000 O:00 N:000 Buffer:89000 - 18% step time =  1.9 ms
C000: 99% step 0137:H0022b22-23 Day +00 22:50 2017-01-01 23:20:00: Rel.:  91,000: Active:91000 M:86882 S:00000  B:04118 D:000 O:00 N:000 Buffer:91000 - 18% step time = 131.4 ms
C000: &gt;&gt;&gt; Note: No open boundaries requested, as run_params[&quot;open_boundary_type&quot;] = 0
C000:       Hint: Requires list of open boundary nodes not in hydro model, eg for Schism this can be read from hgrid file to named in reader params and run_params[&quot;open_boundary_type&quot;] = 1
C000: &gt;&gt;&gt; Warning: &quot;z_mi&quot; is not recognised, ignoring this param.
C000:       in:  &gt;&gt;&gt; adding_class type &gt;&gt; &quot;particle_statistics&quot;  (name=  &quot;my_heatmap&quot; instance # 0),  making class type particle_statistics  &gt;&gt; &quot;z_mi&quot;
C000:       Hint: Closest matches to &quot;z_mi&quot; = ['z_min', 'z_max', 'status_min'] ??
C000:   -  Triangle walk summary: Of  31,133,288 particles located  0, walks were too long and were retried,  of these  0 failed after retrying and were discarded
C000: --------------------------------------------------------------------------
C000:   - Finished case number   0,  heat_map_example started: 2023-06-21 17:05:04.209221, ended: 2023-06-21 17:05:14.628164
C000:       Elapsed time =0:00:10.418943
C000: --------------------------------------------------------------------------
main:     &gt;&gt;&gt; Note: run summary with case file names   &quot;heat_map_example_runInfo.json&quot;
main:     &gt;&gt;&gt; Note: output is in dir= e:H_Local_driveParticleTrackingoceantrackertutorials_how_tooutputheat_map_example
main:     &gt;&gt;&gt; Note: to help with debugging, parameters as given by user  are in &quot;heat_map_example_raw_user_params.json&quot;
main:     &gt;&gt;&gt; Note: run summary with case file names   &quot;heat_map_example_runInfo.json&quot;
main: --------------------------------------------------------------------------
main: OceanTracker summary:  elapsed time =0:00:10.531973
main:       Cases -   0 errors,   3 warnings,   2 notes, check above
main:       Helper-   0 errors,   0 warnings,   0 notes, check above
main:       Main  -   0 errors,   0 warnings,   3 notes, check above
main: --------------------------------------------------------------------------</pre>
<section id="read-and-plot-heat-maps">
<h3>Read and plot heat maps<a class="headerlink" href="#read-and-plot-heat-maps" title="Permalink to this heading">¶</a></h3>
<p>The statistics output from the above run is in file
output:raw-latex:<cite>heat</cite>_map_example:raw-latex:<cite>heat</cite>_map_example_stats_gridded_time_my_heatmap.nc</p>
<p>This netcdf file can be read and organized as a python dictionary by
directly with read_ncdf_output_files.read_stats_file.</p>
<p>To plot use, load_output_files.load_stats_data, which also loads grid
etc for plotting</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read stats files</span>
<span class="kn">from</span> <span class="nn">oceantracker.post_processing.read_output_files</span> <span class="kn">import</span> <span class="n">read_ncdf_output_files</span><span class="p">,</span> <span class="n">load_output_files</span>
<span class="kn">from</span> <span class="nn">oceantracker.post_processing.plotting</span> <span class="kn">import</span> <span class="n">plot_statistics</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span>

<span class="c1"># basic read of net cdf</span>
<span class="n">raw_stats</span> <span class="o">=</span> <span class="n">read_ncdf_output_files</span><span class="o">.</span><span class="n">read_stats_file</span><span class="p">(</span><span class="s1">&#39;output/heat_map_example/heat_map_example_stats_gridded_time_my_heatmap.nc&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;raw_stats&#39;</span><span class="p">,</span> <span class="n">raw_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="c1"># better,  load netcdf plus grid and other data useful in plotting</span>
<span class="c1"># uses case_info name returned from run above</span>
<span class="n">stats_data</span> <span class="o">=</span> <span class="n">load_output_files</span><span class="o">.</span><span class="n">load_stats_data</span><span class="p">(</span><span class="n">case_info_file_name</span><span class="p">,</span><span class="s1">&#39;my_heatmap&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stats&#39;</span><span class="p">,</span><span class="n">stats_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="c1"># use stats_data variable to plot heat map at last time step, by default plots var= &quot;count&quot;</span>
<span class="n">ax</span><span class="o">=</span> <span class="p">[</span><span class="mi">1591000</span><span class="p">,</span> <span class="mi">1601500</span><span class="p">,</span> <span class="mi">5478500</span><span class="p">,</span> <span class="mi">5491000</span><span class="p">]</span>
<span class="n">anim</span><span class="o">=</span> <span class="n">plot_statistics</span><span class="o">.</span><span class="n">animate_heat_map</span><span class="p">(</span><span class="n">stats_data</span><span class="p">,</span> <span class="n">release_group</span><span class="o">=</span><span class="s1">&#39;my_release_point&#39;</span><span class="p">,</span> <span class="n">axis_lims</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">heading</span><span class="o">=</span><span class="s1">&#39;Particle count heatmap built on the fly, no tracks recorded&#39;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span><span class="c1"># this is slow to build!</span>

<span class="c1"># animate the pollutant</span>
<span class="n">anim</span><span class="o">=</span> <span class="n">plot_statistics</span><span class="o">.</span><span class="n">animate_heat_map</span><span class="p">(</span><span class="n">stats_data</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;a_pollutant&#39;</span><span class="p">,</span><span class="n">release_group</span><span class="o">=</span> <span class="s1">&#39;my_release_point&#39;</span><span class="p">,</span> <span class="n">axis_lims</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">heading</span><span class="o">=</span><span class="s1">&#39;Decaying particle property , a_pollutant built on the fly, no tracks recorded&#39;</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">anim</span><span class="o">.</span><span class="n">to_html5_video</span><span class="p">())</span><span class="c1"># this is slow to build!</span>


<span class="c1"># static heat map</span>
<span class="n">plot_statistics</span><span class="o">.</span><span class="n">plot_heat_map</span><span class="p">(</span><span class="n">stats_data</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;a_pollutant&#39;</span><span class="p">,</span><span class="n">release_group</span><span class="o">=</span> <span class="s1">&#39;my_release_point&#39;</span><span class="p">,</span> <span class="n">axis_lims</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>  <span class="n">heading</span><span class="o">=</span><span class="s1">&#39;a_pollutant at last time step  depth built on the fly, no tracks recorded&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">raw_stats</span> <span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;total_num_particles_released&#39;</span><span class="p">,</span> <span class="s1">&#39;release_groupID_my_release_point&#39;</span><span class="p">,</span> <span class="s1">&#39;dimensions&#39;</span><span class="p">,</span> <span class="s1">&#39;limits&#39;</span><span class="p">,</span> <span class="s1">&#39;release_groupID&#39;</span><span class="p">,</span> <span class="s1">&#39;release_locations&#39;</span><span class="p">,</span> <span class="s1">&#39;grid_cell_area&#39;</span><span class="p">,</span> <span class="s1">&#39;count_all_particles&#39;</span><span class="p">,</span> <span class="s1">&#39;num_released&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_a_pollutant&#39;</span><span class="p">,</span> <span class="s1">&#39;release_points&#39;</span><span class="p">,</span> <span class="s1">&#39;number_of_release_points&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;is_polygon_release&#39;</span><span class="p">,</span> <span class="s1">&#39;number_released_each_release_group&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;time_var&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;stats_type&#39;</span><span class="p">,</span> <span class="s1">&#39;connectivity_matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;a_pollutant&#39;</span><span class="p">])</span>
<span class="n">stats</span> <span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;total_num_particles_released&#39;</span><span class="p">,</span> <span class="s1">&#39;release_groupID_my_release_point&#39;</span><span class="p">,</span> <span class="s1">&#39;dimensions&#39;</span><span class="p">,</span> <span class="s1">&#39;limits&#39;</span><span class="p">,</span> <span class="s1">&#39;release_groupID&#39;</span><span class="p">,</span> <span class="s1">&#39;release_locations&#39;</span><span class="p">,</span> <span class="s1">&#39;grid_cell_area&#39;</span><span class="p">,</span> <span class="s1">&#39;count_all_particles&#39;</span><span class="p">,</span> <span class="s1">&#39;num_released&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;sum_a_pollutant&#39;</span><span class="p">,</span> <span class="s1">&#39;release_points&#39;</span><span class="p">,</span> <span class="s1">&#39;number_of_release_points&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;is_polygon_release&#39;</span><span class="p">,</span> <span class="s1">&#39;number_released_each_release_group&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;time_var&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;stats_type&#39;</span><span class="p">,</span> <span class="s1">&#39;connectivity_matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;a_pollutant&#39;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="s1">&#39;release_group_centered_grids&#39;</span><span class="p">,</span> <span class="s1">&#39;particle_status_flags&#39;</span><span class="p">,</span> <span class="s1">&#39;particle_release_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;full_case_params&#39;</span><span class="p">,</span> <span class="s1">&#39;grid&#39;</span><span class="p">])</span>
<span class="n">animate_heat_map</span><span class="o">&gt;</span> <span class="n">colour</span> <span class="n">axis</span> <span class="n">limits</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4023</span><span class="p">]</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4023</span><span class="p">]</span>
</pre></div>
</div>
<img alt="info/how_to/G_onthefly_statistics_files%5CG_onthefly_statistics_4_1.png" src="info/how_to/G_onthefly_statistics_files%5CG_onthefly_statistics_4_1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">animate_heat_map</span><span class="o">&gt;</span> <span class="n">colour</span> <span class="n">axis</span> <span class="n">limits</span> <span class="p">[</span><span class="mf">1.4321606718741004e-07</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]</span> <span class="p">[</span><span class="mf">1.4321606718741004e-07</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]</span>
</pre></div>
</div>
<img alt="info/how_to/G_onthefly_statistics_files%5CG_onthefly_statistics_4_3.png" src="info/how_to/G_onthefly_statistics_files%5CG_onthefly_statistics_4_3.png" />
</section>
</section>
<section id="polygon-example">
<h2>Polygon example<a class="headerlink" href="#polygon-example" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># add polygon stats example with plotting</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Polygon Statistics example.py run using dictionary of parameters</span>
<span class="c1">#------------------------------------------------</span>
<span class="kn">from</span> <span class="nn">oceantracker</span> <span class="kn">import</span> <span class="n">main</span>

<span class="n">params</span> <span class="o">=</span> <span class="n">main</span><span class="o">.</span><span class="n">param_template</span><span class="p">()</span>  <span class="c1"># start with template</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;output_file_base&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;polygon_connectivity_map_example&#39;</span>  <span class="c1"># name used as base for output files</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;root_output_dir&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;output&#39;</span>             <span class="c1">#  output is put in dir   &#39;root_output_dir&#39;\\&#39;output_file_base&#39;</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;time_step&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mf">600.</span> <span class="c1">#  10 min time step as seconds</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;write_tracks&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># particle tracks not needed for on fly</span>

<span class="c1"># ot.set_class, sets parameters for a named class</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;reader&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;input_dir&#39;</span><span class="p">:</span> <span class="s1">&#39;../demos/demo_hindcast&#39;</span><span class="p">,</span>  <span class="c1"># folder to search for hindcast files, sub-dirs will, by default, also be searched</span>
                    <span class="s1">&#39;file_mask&#39;</span><span class="p">:</span>  <span class="s1">&#39;demoHindcastSchism*.nc&#39;</span><span class="p">}</span>  <span class="c1"># hindcast file mask</span>

<span class="c1"># add one release locations</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;release_groups&#39;</span><span class="p">][</span><span class="s1">&#39;my_release_point&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{</span> <span class="c1"># user must provide a name for group first</span>
                        <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="p">[</span><span class="mi">1599000</span><span class="p">,</span> <span class="mi">5486200</span><span class="p">]],</span>       <span class="c1"># ust be 1 by N list pairs of release locations</span>
                        <span class="s1">&#39;release_interval&#39;</span><span class="p">:</span> <span class="mi">900</span><span class="p">,</span>           <span class="c1"># seconds between releasing particles</span>
                        <span class="s1">&#39;pulse_size&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>                   <span class="c1"># number of particles released each release_interval</span>
            <span class="p">}</span>

<span class="c1"># add a gridded particle statistic</span>
<span class="n">params</span><span class="p">[</span><span class="s1">&#39;particle_statistics&#39;</span><span class="p">][</span><span class="s1">&#39;my_polygon&#39;</span><span class="p">]</span><span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;class_name&#39;</span><span class="p">:</span> <span class="s1">&#39;oceantracker.particle_statistics.polygon_statistics.PolygonStats2D_timeBased&#39;</span><span class="p">,</span>
                <span class="s1">&#39;polygon_list&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span>   <span class="p">[</span><span class="mf">1597682.1237</span><span class="p">,</span> <span class="mf">5489972.7479</span><span class="p">],</span><span class="c1"># list of one or more polygons</span>
                                                <span class="p">[</span><span class="mf">1598604.1667</span><span class="p">,</span> <span class="mf">5490275.5488</span><span class="p">],</span>
                                                <span class="p">[</span><span class="mf">1598886.4247</span><span class="p">,</span> <span class="mf">5489464.0424</span><span class="p">],</span>
                                                <span class="p">[</span><span class="mf">1597917.3387</span><span class="p">,</span> <span class="mi">5489000</span><span class="p">],</span>
                                                <span class="p">[</span><span class="mi">1597300</span><span class="p">,</span> <span class="mi">5489000</span><span class="p">],</span> <span class="p">[</span><span class="mf">1597682.1237</span><span class="p">,</span> <span class="mf">5489972.7479</span><span class="p">]</span>
                                                <span class="p">]</span>
                                  <span class="p">}],</span>
                <span class="c1"># the below settings are optional</span>
                <span class="s1">&#39;update_interval&#39;</span><span class="p">:</span> <span class="mi">900</span><span class="p">,</span> <span class="c1"># time interval in sec, between doing particle statists counts</span>
                <span class="s1">&#39;status_min&#39;</span><span class="p">:</span><span class="s1">&#39;moving&#39;</span><span class="p">,</span> <span class="c1"># only count the particles which are moving</span>
                <span class="p">}</span>

<span class="c1"># run oceantracker</span>
<span class="n">poly_case_info_file_name</span> <span class="o">=</span> <span class="n">main</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">main: --------------------------------------------------------------------------
main: OceanTracker- preliminary setup
main:      Python version: 3.10.9 | packaged by conda-forge | (main, Jan 11 2023, 15:15:40) [MSC v.1916 64 bit (AMD64)]
main:   - found hydro-model files of type SCHISIM
main:       -  sorted hyrdo-model files in time order,        0.497 sec
main:     &gt;&gt;&gt; Note: output is in dir= e:H_Local_driveParticleTrackingoceantrackertutorials_how_tooutputpolygon_connectivity_map_example
main:     &gt;&gt;&gt; Note: to help with debugging, parameters as given by user  are in &quot;polygon_connectivity_map_example_raw_user_params.json&quot;
C000: --------------------------------------------------------------------------
C000: Starting case number   0,  polygon_connectivity_map_example at 2023-06-21T16:57:14.090697
C000: --------------------------------------------------------------------------
C000:       -  built node to triangles map,   0.771 sec
C000:       -  built triangle adjacency matrix,       0.341 sec
C000:       -  found boundary triangles,      0.000 sec
C000:       -  built domain and island outlines,      1.583 sec
C000:       -  calculated triangle areas,     0.000 sec
C000:   Finished grid setup
C000:       -  set up release_groups,         0.002 sec
C000:       -  built barycentric-transform matrix,    0.456 sec
C000:       -  initial set up of core classes,        0.472 sec
C000:       -  final set up of core classes,          0.001 sec
C000:       -  created particle properties derived from fields,       0.003 sec
C000: &gt;&gt;&gt; Note: No open boundaries requested, as run_params[&quot;open_boundary_type&quot;] = 0
C000:       Hint: Requires list of open boundary nodes not in hydro model, eg for Schism this can be read from hgrid file to named in reader params and run_params[&quot;open_boundary_type&quot;] = 1
C000: --------------------------------------------------------------------------
C000:   - Starting polygon_connectivity_map_example,  duration: 0 days 23 hrs 0 min 0 sec
C000:       -  Initialized Solver Class,      0.000 sec
C000: 00% step 0000:H0000b00-01 Day +00 00:00 2017-01-01 00:30:00: Rel.:   1,000: Active:01000 M:01000 S:00000  B:00000 D:000 O:00 N:000 Buffer:1000 -  0% step time = 6152.3 ms
C000:   - Reading-file-00  demoHindcastSchism3D.nc, steps in file  24, steps  available 000:023, reading  24 of 48 steps,  for hydo-model time steps 00:23,  from file offsets 00:23,  into ring buffer offsets 000:023
C000:       -  read  24 time steps in  0.6 sec
C000:   - opening tracks output to : polygon_connectivity_map_example_tracks_compact.nc
C000: 04% step 0006:H0001b01-02 Day +00 01:00 2017-01-01 01:30:00: Rel.:   5,000: Active:05000 M:04756 S:00000  B:00244 D:000 O:00 N:000 Buffer:5000 -  1% step time =  1.5 ms
C000: 09% step 0012:H0002b02-03 Day +00 02:00 2017-01-01 02:30:00: Rel.:   9,000: Active:09000 M:08498 S:00004  B:00498 D:000 O:00 N:000 Buffer:9000 -  2% step time =  1.5 ms
C000: 13% step 0018:H0003b03-04 Day +00 03:00 2017-01-01 03:30:00: Rel.:  13,000: Active:13000 M:12257 S:00145  B:00598 D:000 O:00 N:000 Buffer:13000 -  3% step time =  1.7 ms
C000: 17% step 0024:H0004b04-05 Day +00 04:00 2017-01-01 04:30:00: Rel.:  17,000: Active:17000 M:16143 S:00145  B:00712 D:000 O:00 N:000 Buffer:17000 -  3% step time =  1.5 ms
C000: 22% step 0030:H0005b05-06 Day +00 05:00 2017-01-01 05:30:00: Rel.:  21,000: Active:21000 M:20120 S:00145  B:00735 D:000 O:00 N:000 Buffer:21000 -  4% step time =  1.7 ms
C000: 26% step 0036:H0006b06-07 Day +00 06:00 2017-01-01 06:30:00: Rel.:  25,000: Active:25000 M:24034 S:00145  B:00821 D:000 O:00 N:000 Buffer:25000 -  5% step time =  1.6 ms
C000: 30% step 0042:H0007b07-08 Day +00 07:00 2017-01-01 07:30:00: Rel.:  29,000: Active:29000 M:27703 S:00145  B:01152 D:000 O:00 N:000 Buffer:29000 -  6% step time =  1.7 ms
C000: 35% step 0048:H0008b08-09 Day +00 08:00 2017-01-01 08:30:00: Rel.:  33,000: Active:33000 M:31490 S:00145  B:01365 D:000 O:00 N:000 Buffer:33000 -  7% step time =  1.7 ms
C000: 39% step 0054:H0009b09-10 Day +00 09:00 2017-01-01 09:30:00: Rel.:  37,000: Active:37000 M:35517 S:00003  B:01480 D:000 O:00 N:000 Buffer:37000 -  7% step time =  1.7 ms
C000: 43% step 0060:H0010b10-11 Day +00 10:00 2017-01-01 10:30:00: Rel.:  41,000: Active:41000 M:39274 S:00000  B:01726 D:000 O:00 N:000 Buffer:41000 -  8% step time =  1.7 ms
C000: 48% step 0066:H0011b11-12 Day +00 11:00 2017-01-01 11:30:00: Rel.:  45,000: Active:45000 M:42989 S:00000  B:02011 D:000 O:00 N:000 Buffer:45000 -  9% step time =  1.7 ms
C000: 52% step 0072:H0012b12-13 Day +00 12:00 2017-01-01 12:30:00: Rel.:  49,000: Active:49000 M:46957 S:00000  B:02043 D:000 O:00 N:000 Buffer:49000 - 10% step time =  1.7 ms
C000: 57% step 0078:H0012b12-13 Day +00 13:00 2017-01-01 13:30:00: Rel.:  53,000: Active:53000 M:50973 S:00000  B:02027 D:000 O:00 N:000 Buffer:53000 - 11% step time =  1.8 ms
C000: 61% step 0084:H0014b14-15 Day +00 14:00 2017-01-01 14:30:00: Rel.:  57,000: Active:57000 M:54577 S:00390  B:02033 D:000 O:00 N:000 Buffer:57000 - 11% step time =  1.8 ms
C000: 65% step 0090:H0015b15-16 Day +00 15:00 2017-01-01 15:30:00: Rel.:  61,000: Active:61000 M:58243 S:00732  B:02025 D:000 O:00 N:000 Buffer:61000 - 12% step time =  1.8 ms
C000: 70% step 0096:H0016b16-17 Day +00 16:00 2017-01-01 16:30:00: Rel.:  65,000: Active:65000 M:62385 S:00732  B:01883 D:000 O:00 N:000 Buffer:65000 - 13% step time =  1.8 ms
C000: 74% step 0102:H0017b17-18 Day +00 17:00 2017-01-01 17:30:00: Rel.:  69,000: Active:69000 M:66360 S:00732  B:01908 D:000 O:00 N:000 Buffer:69000 - 14% step time =  1.8 ms
C000: 78% step 0108:H0018b18-19 Day +00 18:00 2017-01-01 18:30:00: Rel.:  73,000: Active:73000 M:70151 S:00732  B:02117 D:000 O:00 N:000 Buffer:73000 - 15% step time =  1.9 ms
C000: 83% step 0114:H0019b19-20 Day +00 19:00 2017-01-01 19:30:00: Rel.:  77,000: Active:77000 M:73699 S:00732  B:02569 D:000 O:00 N:000 Buffer:77000 - 15% step time =  1.8 ms
C000: 87% step 0120:H0020b20-21 Day +00 20:00 2017-01-01 20:30:00: Rel.:  81,000: Active:81000 M:77497 S:00732  B:02771 D:000 O:00 N:000 Buffer:81000 - 16% step time =  1.8 ms
C000: 91% step 0126:H0021b21-22 Day +00 21:00 2017-01-01 21:30:00: Rel.:  85,000: Active:85000 M:81260 S:00369  B:03371 D:000 O:00 N:000 Buffer:85000 - 17% step time =  1.9 ms
C000: 96% step 0132:H0022b22-23 Day +00 22:00 2017-01-01 22:30:00: Rel.:  89,000: Active:89000 M:85063 S:00000  B:03937 D:000 O:00 N:000 Buffer:89000 - 18% step time =  1.9 ms
C000: 99% step 0137:H0022b22-23 Day +00 22:50 2017-01-01 23:20:00: Rel.:  91,000: Active:91000 M:86830 S:00000  B:04170 D:000 O:00 N:000 Buffer:91000 - 18% step time = 125.5 ms
C000: &gt;&gt;&gt; Note: No open boundaries requested, as run_params[&quot;open_boundary_type&quot;] = 0
C000:       Hint: Requires list of open boundary nodes not in hydro model, eg for Schism this can be read from hgrid file to named in reader params and run_params[&quot;open_boundary_type&quot;] = 1
C000:   -  Triangle walk summary: Of  31,121,160 particles located  0, walks were too long and were retried,  of these  0 failed after retrying and were discarded
C000: --------------------------------------------------------------------------
C000:   - Finished case number   0,  polygon_connectivity_map_example started: 2023-06-21 16:57:14.088417, ended: 2023-06-21 16:57:39.285801
C000:       Elapsed time =0:00:25.197384
C000: --------------------------------------------------------------------------
main:     &gt;&gt;&gt; Note: run summary with case file names   &quot;polygon_connectivity_map_example_runInfo.json&quot;
main:     &gt;&gt;&gt; Note: output is in dir= e:H_Local_driveParticleTrackingoceantrackertutorials_how_tooutputpolygon_connectivity_map_example
main:     &gt;&gt;&gt; Note: to help with debugging, parameters as given by user  are in &quot;polygon_connectivity_map_example_raw_user_params.json&quot;
main:     &gt;&gt;&gt; Note: run summary with case file names   &quot;polygon_connectivity_map_example_runInfo.json&quot;
main: --------------------------------------------------------------------------
main: OceanTracker summary:  elapsed time =0:00:25.807328
main:       Cases -   0 errors,   0 warnings,   2 notes, check above
main:       Helper-   0 errors,   0 warnings,   0 notes, check above
main:       Main  -   0 errors,   0 warnings,   3 notes, check above
main: --------------------------------------------------------------------------</pre>
</section>
<section id="read-polygon-connectivity-statistics">
<h2>Read polygon/connectivity statistics<a class="headerlink" href="#read-polygon-connectivity-statistics" title="Permalink to this heading">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Read polygon stats and calculate connectivity matrix</span>
<span class="kn">from</span> <span class="nn">oceantracker.post_processing.read_output_files</span> <span class="kn">import</span> <span class="n">load_output_files</span>

<span class="n">poly_stats_data</span> <span class="o">=</span> <span class="n">load_output_files</span><span class="o">.</span><span class="n">load_stats_data</span><span class="p">(</span><span class="n">poly_case_info_file_name</span><span class="p">,</span><span class="s1">&#39;my_polygon&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;stats&#39;</span><span class="p">,</span><span class="n">poly_stats_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">poly_stats_data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">poly_stats_data</span><span class="p">[</span><span class="s1">&#39;connectivity_matrix&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Connectivity time series between release point and polygon&#39;</span><span class="p">)</span>

<span class="c1">#print(poly_stats_data[&#39;date&#39;])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span> <span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;total_num_particles_released&#39;</span><span class="p">,</span> <span class="s1">&#39;release_groupID_my_release_point&#39;</span><span class="p">,</span> <span class="s1">&#39;dimensions&#39;</span><span class="p">,</span> <span class="s1">&#39;limits&#39;</span><span class="p">,</span> <span class="s1">&#39;release_groupID&#39;</span><span class="p">,</span> <span class="s1">&#39;release_locations&#39;</span><span class="p">,</span> <span class="s1">&#39;count_all_particles&#39;</span><span class="p">,</span> <span class="s1">&#39;num_released&#39;</span><span class="p">,</span> <span class="s1">&#39;release_points&#39;</span><span class="p">,</span> <span class="s1">&#39;number_of_release_points&#39;</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;is_polygon_release&#39;</span><span class="p">,</span> <span class="s1">&#39;number_released_each_release_group&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;time_var&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;stats_type&#39;</span><span class="p">,</span> <span class="s1">&#39;connectivity_matrix&#39;</span><span class="p">,</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="s1">&#39;params&#39;</span><span class="p">,</span> <span class="s1">&#39;release_group_centered_grids&#39;</span><span class="p">,</span> <span class="s1">&#39;polygon_list&#39;</span><span class="p">,</span> <span class="s1">&#39;particle_status_flags&#39;</span><span class="p">,</span> <span class="s1">&#39;particle_release_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;full_case_params&#39;</span><span class="p">,</span> <span class="s1">&#39;grid&#39;</span><span class="p">])</span>
<span class="p">[</span><span class="s1">&#39;2017-01-01T00:30:00&#39;</span> <span class="s1">&#39;2017-01-01T00:50:00&#39;</span> <span class="s1">&#39;2017-01-01T01:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T01:30:00&#39;</span> <span class="s1">&#39;2017-01-01T01:50:00&#39;</span> <span class="s1">&#39;2017-01-01T02:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T02:30:00&#39;</span> <span class="s1">&#39;2017-01-01T02:50:00&#39;</span> <span class="s1">&#39;2017-01-01T03:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T03:30:00&#39;</span> <span class="s1">&#39;2017-01-01T03:50:00&#39;</span> <span class="s1">&#39;2017-01-01T04:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T04:30:00&#39;</span> <span class="s1">&#39;2017-01-01T04:50:00&#39;</span> <span class="s1">&#39;2017-01-01T05:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T05:30:00&#39;</span> <span class="s1">&#39;2017-01-01T05:50:00&#39;</span> <span class="s1">&#39;2017-01-01T06:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T06:30:00&#39;</span> <span class="s1">&#39;2017-01-01T06:50:00&#39;</span> <span class="s1">&#39;2017-01-01T07:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T07:30:00&#39;</span> <span class="s1">&#39;2017-01-01T07:50:00&#39;</span> <span class="s1">&#39;2017-01-01T08:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T08:30:00&#39;</span> <span class="s1">&#39;2017-01-01T08:50:00&#39;</span> <span class="s1">&#39;2017-01-01T09:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T09:30:00&#39;</span> <span class="s1">&#39;2017-01-01T09:50:00&#39;</span> <span class="s1">&#39;2017-01-01T10:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T10:30:00&#39;</span> <span class="s1">&#39;2017-01-01T10:50:00&#39;</span> <span class="s1">&#39;2017-01-01T11:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T11:30:00&#39;</span> <span class="s1">&#39;2017-01-01T11:50:00&#39;</span> <span class="s1">&#39;2017-01-01T12:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T12:30:00&#39;</span> <span class="s1">&#39;2017-01-01T12:50:00&#39;</span> <span class="s1">&#39;2017-01-01T13:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T13:30:00&#39;</span> <span class="s1">&#39;2017-01-01T13:50:00&#39;</span> <span class="s1">&#39;2017-01-01T14:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T14:30:00&#39;</span> <span class="s1">&#39;2017-01-01T14:50:00&#39;</span> <span class="s1">&#39;2017-01-01T15:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T15:30:00&#39;</span> <span class="s1">&#39;2017-01-01T15:50:00&#39;</span> <span class="s1">&#39;2017-01-01T16:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T16:30:00&#39;</span> <span class="s1">&#39;2017-01-01T16:50:00&#39;</span> <span class="s1">&#39;2017-01-01T17:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T17:30:00&#39;</span> <span class="s1">&#39;2017-01-01T17:50:00&#39;</span> <span class="s1">&#39;2017-01-01T18:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T18:30:00&#39;</span> <span class="s1">&#39;2017-01-01T18:50:00&#39;</span> <span class="s1">&#39;2017-01-01T19:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T19:30:00&#39;</span> <span class="s1">&#39;2017-01-01T19:50:00&#39;</span> <span class="s1">&#39;2017-01-01T20:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T20:30:00&#39;</span> <span class="s1">&#39;2017-01-01T20:50:00&#39;</span> <span class="s1">&#39;2017-01-01T21:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T21:30:00&#39;</span> <span class="s1">&#39;2017-01-01T21:50:00&#39;</span> <span class="s1">&#39;2017-01-01T22:10:00&#39;</span>
 <span class="s1">&#39;2017-01-01T22:30:00&#39;</span> <span class="s1">&#39;2017-01-01T22:50:00&#39;</span> <span class="s1">&#39;2017-01-01T23:10:00&#39;</span><span class="p">]</span>
</pre></div>
</div>
<img alt="info/how_to/G_onthefly_statistics_files%5CG_onthefly_statistics_8_1.png" src="info/how_to/G_onthefly_statistics_files%5CG_onthefly_statistics_8_1.png" />
</section>
<section id="time-verses-age-statistics">
<h2>Time verses Age statistics<a class="headerlink" href="#time-verses-age-statistics" title="Permalink to this heading">¶</a></h2>
<p>Both gridded and polygon statistics come in two types, “time” and “age”.</p>
<ul class="simple">
<li><p>“time” statistics are time series, or snapshots, of particle numbers
and particle properties at a time interval given by
“calculation_interval” parameter. Eg. gridded stats showing how the
heat map of a source’s plume evolves over time.</p></li>
<li><p>“age” statistics are particle counts and properties binned by
particle age. The result are age based histograms of counts or
particle proprieties. This is useful to give numbers in each age band
arriving at a given grid cell or polygon, from each release group.
Eg. counting how many larvae are old enough to settle in a polygon or
grid cell from each potential source location.</p></li>
</ul>
</section>
</section>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="F_plotting_tracks.html" title="Previous document">plotting tracks</a>
        </li>
        <li>
          <a href="P_running_cases_in_parallel.html" title="Next document">Run in parallel</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, R. Vennell.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/info/how_to/G_onthefly_statistics.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>