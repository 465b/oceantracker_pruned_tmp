M: --------------------------------------------------------------------------
M: OceanTracker preliminary setup
M: --------------------------------------------------------------------------
M: Running OceanTracker started 2023-05-06 20:00:36.770146
M:   - Starting: Sounds
M: --------------------------------------------------------------------------
M: Starting OceanTracker  Version 0.4.00.003 2023-04-27
M:   Python version: 3.10.9 | packaged by conda-forge | (main, Jan 11 2023, 15:15:40) [MSC v.1916 64 bit (AMD64)]
M:       -  sorted hyrdo-model files in time order,	  0.648 sec
M:       -  built node to triangles map,	  1.082 sec
M:       -  built triangle adjacency matrix,	  0.330 sec
M:       -  found boundary triangles,	  0.004 sec
M:       -  built domain and island outlines,	  2.376 sec
M:       -  calculated triangle areas,	  0.010 sec
M:   - Input directory: G:\Hindcasts_large\MalbroughSounds_10year_benPhD\2008
M:   - Setting up params for each case 
M:       -  merged param defaults and buildting case params,	  0.063 sec
M: --------------------------------------------------------------------------
P000: --------------------------------------------------------------------------
P000: Starting case number   0,  Sounds at 2023-05-06T20:00:42.434469
P000: --------------------------------------------------------------------------
P000: >>> Note: Running in debug mode
P000:       -  built node to triangles map,	  0.010 sec
P000:       -  built triangle adjacency matrix,	  0.028 sec
P000:       -  found boundary triangles,	  0.004 sec
P000:       -  built domain and island outlines,	  1.412 sec
P000:       -  calculated triangle areas,	  0.010 sec
P000:       -  set up particle_release_groups,	  0.667 sec
P000:       -  initial set up of core classes,	  1.130 sec
P000:       -  final set up of core classes,	  0.000 sec
P000:       -  created particle properties derived from fields,	  0.003 sec
P000: >>> Note: When use aged binned particle stats, to get un biases stats., need to stop releasing particles "max_age_to_bin"  or max("user_age_bin_edges")  before end of run, by setting  particle param "release_duration"
P000: >>> Note: When use aged binned particle stats, to get un biases stats., need to stop releasing particles "max_age_to_bin"  or max("user_age_bin_edges")  before end of run, by setting  particle param "release_duration"
P000: >>> Note: No open boundaries requested, as run_params["open_boundary_type"] = 0
P000:       Hint: Requires list of open boundary nodes not in hydro model, eg for Schism this can be read from hgrid file to named in reader params and run_params["open_boundary_type"] = 1
P000: --------------------------------------------------------------------------
P000:   - Starting Sounds,  duration: 6 days 0 hrs 0 min 0 sec
P000:   - Reading-file-01  schism_marl20080101_00z_3D.nc, steps in file  48, steps  available 000:047, reading  48 of 48 steps,  for hydo-model time steps 00:47,  from file offsets 00:47,  into ring buffer offsets 000:047 
P000:       -  read  48 time steps in  22.7 sec
P000: 00% step 0000:H0000b00-01 Day +00 00:00 2008-01-01 00:30:00: Rel.:003500: Active:03500 M:03251 S:00000 B:00249 D:000 O:00 N:0 Buffer:3500-  1% step time = 39170.9 ms
P000: 00% step 0006:H0001b01-02 Day +00 00:30 2008-01-01 01:00:00: Rel.:003500: Active:03500 M:03311 S:00000 B:00189 D:000 O:00 N:0 Buffer:3500-  1% step time = 11.3 ms
P000: 01% step 0012:H0002b02-03 Day +00 01:00 2008-01-01 01:30:00: Rel.:007000: Active:07000 M:06581 S:00000 B:00419 D:000 O:00 N:0 Buffer:7000-  1% step time = 23.0 ms
P000: 01% step 0018:H0003b03-04 Day +00 01:30 2008-01-01 02:00:00: Rel.:007000: Active:07000 M:06613 S:00000 B:00387 D:000 O:00 N:0 Buffer:7000-  1% step time = 16.7 ms
P000: 01% step 0024:H0004b04-05 Day +00 02:00 2008-01-01 02:30:00: Rel.:010500: Active:10500 M:09874 S:00000 B:00626 D:000 O:00 N:0 Buffer:10500-  2% step time = 28.3 ms
P000: 02% step 0030:H0005b05-06 Day +00 02:30 2008-01-01 03:00:00: Rel.:010500: Active:10500 M:09940 S:00000 B:00560 D:000 O:00 N:0 Buffer:10500-  2% step time = 22.3 ms
P000: 02% step 0036:H0006b06-07 Day +00 03:00 2008-01-01 03:30:00: Rel.:014000: Active:14000 M:13143 S:00000 B:00857 D:000 O:00 N:0 Buffer:14000-  3% step time = 34.9 ms
P000: 02% step 0042:H0007b07-08 Day +00 03:30 2008-01-01 04:00:00: Rel.:014000: Active:14000 M:13239 S:00000 B:00761 D:000 O:00 N:0 Buffer:14000-  3% step time = 27.8 ms
P000: 03% step 0048:H0008b08-09 Day +00 04:00 2008-01-01 04:30:00: Rel.:017500: Active:17500 M:16487 S:00072 B:00941 D:000 O:00 N:0 Buffer:17500-  3% step time = 39.4 ms
P000: 03% step 0054:H0009b09-10 Day +00 04:30 2008-01-01 05:00:00: Rel.:017500: Active:17500 M:16565 S:00072 B:00863 D:000 O:00 N:0 Buffer:17500-  3% step time = 33.2 ms
P000: 03% step 0060:H0010b10-11 Day +00 05:00 2008-01-01 05:30:00: Rel.:021000: Active:21000 M:19709 S:00243 B:01048 D:000 O:00 N:0 Buffer:21000-  4% step time = 44.3 ms
P000: 04% step 0066:H0011b11-12 Day +00 05:30 2008-01-01 06:00:00: Rel.:021000: Active:21000 M:19715 S:00285 B:01000 D:000 O:00 N:0 Buffer:21000-  4% step time = 38.4 ms
P000: 04% step 0072:H0012b12-13 Day +00 06:00 2008-01-01 06:30:00: Rel.:024500: Active:24500 M:22879 S:00297 B:01324 D:000 O:00 N:0 Buffer:24500-  5% step time = 51.7 ms
P000: 05% step 0078:H0013b13-14 Day +00 06:30 2008-01-01 07:00:00: Rel.:024500: Active:24500 M:22659 S:00362 B:01479 D:000 O:00 N:0 Buffer:24500-  5% step time = 43.9 ms
P000: 05% step 0084:H0014b14-15 Day +00 07:00 2008-01-01 07:30:00: Rel.:028000: Active:28000 M:25371 S:01210 B:01419 D:000 O:00 N:0 Buffer:28000-  5% step time = 54.4 ms
P000: 05% step 0090:H0015b15-16 Day +00 07:30 2008-01-01 08:00:00: Rel.:028000: Active:28000 M:23985 S:03762 B:00253 D:000 O:00 N:0 Buffer:28000-  5% step time = 46.2 ms
P000: 06% step 0096:H0016b16-17 Day +00 08:00 2008-01-01 08:30:00: Rel.:031500: Active:31500 M:27009 S:04262 B:00229 D:000 O:00 N:0 Buffer:31500-  6% step time = 56.3 ms
P000: 06% step 0102:H0017b17-18 Day +00 08:30 2008-01-01 09:00:00: Rel.:031500: Active:31500 M:26900 S:04440 B:00160 D:000 O:00 N:0 Buffer:31500-  6% step time = 50.1 ms
P000: 06% step 0108:H0018b18-19 Day +00 09:00 2008-01-01 09:30:00: Rel.:035000: Active:35000 M:29897 S:04940 B:00163 D:000 O:00 N:0 Buffer:35000-  7% step time = 63.3 ms
P000: 07% step 0114:H0019b19-20 Day +00 09:30 2008-01-01 10:00:00: Rel.:035000: Active:35000 M:29874 S:04940 B:00186 D:000 O:00 N:0 Buffer:35000-  7% step time = 54.9 ms
P000: 07% step 0120:H0020b20-21 Day +00 10:00 2008-01-01 10:30:00: Rel.:038500: Active:38500 M:32838 S:05440 B:00222 D:000 O:00 N:0 Buffer:38500-  7% step time = 65.5 ms
P000: 07% step 0126:H0021b21-22 Day +00 10:30 2008-01-01 11:00:00: Rel.:038500: Active:38500 M:32877 S:05440 B:00183 D:000 O:00 N:0 Buffer:38500-  7% step time = 59.6 ms
P000: 08% step 0132:H0022b22-23 Day +00 11:00 2008-01-01 11:30:00: Rel.:042000: Active:42000 M:35849 S:05940 B:00211 D:000 O:00 N:0 Buffer:42000-  8% step time = 70.8 ms
P000: 08% step 0138:H0023b23-24 Day +00 11:30 2008-01-01 12:00:00: Rel.:042000: Active:42000 M:35842 S:05940 B:00218 D:000 O:00 N:0 Buffer:42000-  8% step time = 64.6 ms
P000: 08% step 0144:H0024b24-25 Day +00 12:00 2008-01-01 12:30:00: Rel.:045500: Active:45500 M:38836 S:06440 B:00224 D:000 O:00 N:0 Buffer:45500-  9% step time = 78.9 ms
P000: 09% step 0150:H0025b25-26 Day +00 12:30 2008-01-01 13:00:00: Rel.:045500: Active:45500 M:40358 S:03710 B:01432 D:000 O:00 N:0 Buffer:45500-  9% step time = 73.1 ms
P000: 09% step 0156:H0026b26-27 Day +00 13:00 2008-01-01 13:30:00: Rel.:049000: Active:49000 M:45595 S:00362 B:03043 D:000 O:00 N:0 Buffer:49000-  9% step time = 89.3 ms
P000: 09% step 0162:H0027b27-28 Day +00 13:30 2008-01-01 14:00:00: Rel.:049000: Active:49000 M:45893 S:00297 B:02810 D:000 O:00 N:0 Buffer:49000-  9% step time = 82.2 ms
P000: 10% step 0168:H0028b28-29 Day +00 14:00 2008-01-01 14:30:00: Rel.:052500: Active:52500 M:49308 S:00285 B:02907 D:000 O:00 N:0 Buffer:52500- 10% step time = 94.6 ms
P000: 10% step 0174:H0029b29-30 Day +00 14:30 2008-01-01 15:00:00: Rel.:052500: Active:52500 M:49475 S:00243 B:02782 D:000 O:00 N:0 Buffer:52500- 10% step time = 88.5 ms
P000: 10% step 0180:H0030b30-31 Day +00 15:00 2008-01-01 15:30:00: Rel.:056000: Active:56000 M:52505 S:00082 B:03413 D:000 O:00 N:0 Buffer:56000- 11% step time = 104.1 ms
P000: 11% step 0186:H0031b31-32 Day +00 15:30 2008-01-01 16:00:00: Rel.:056000: Active:56000 M:52329 S:00073 B:03598 D:000 O:00 N:0 Buffer:56000- 11% step time = 93.5 ms
P000: 11% step 0192:H0032b32-33 Day +00 16:00 2008-01-01 16:30:00: Rel.:059500: Active:59500 M:55591 S:00072 B:03837 D:000 O:00 N:0 Buffer:59500- 11% step time = 105.3 ms
P000: 11% step 0198:H0033b33-34 Day +00 16:30 2008-01-01 17:00:00: Rel.:059500: Active:59500 M:55584 S:00544 B:03372 D:000 O:00 N:0 Buffer:59500- 11% step time = 100.8 ms
P000: 12% step 0204:H0034b34-35 Day +00 17:00 2008-01-01 17:30:00: Rel.:063000: Active:63000 M:58118 S:02164 B:02718 D:000 O:00 N:0 Buffer:63000- 12% step time = 107.8 ms
P000: 12% step 0210:H0035b35-36 Day +00 17:30 2008-01-01 18:00:00: Rel.:063000: Active:63000 M:58132 S:02187 B:02681 D:000 O:00 N:0 Buffer:63000- 12% step time = 102.2 ms
P000: 12% step 0216:H0036b36-37 Day +00 18:00 2008-01-01 18:30:00: Rel.:066500: Active:66500 M:61143 S:02717 B:02640 D:000 O:00 N:0 Buffer:66500- 13% step time = 122.9 ms
P000: 13% step 0222:H0037b37-38 Day +00 18:30 2008-01-01 19:00:00: Rel.:066500: Active:66500 M:61021 S:02894 B:02585 D:000 O:00 N:0 Buffer:66500- 13% step time = 109.3 ms
P000: 13% step 0228:H0038b38-39 Day +00 19:00 2008-01-01 19:30:00: Rel.:070000: Active:70000 M:64041 S:02945 B:03014 D:000 O:00 N:0 Buffer:70000- 13% step time = 121.3 ms
P000: 14% step 0234:H0039b39-40 Day +00 19:30 2008-01-01 20:00:00: Rel.:070000: Active:70000 M:63271 S:03818 B:02911 D:000 O:00 N:0 Buffer:70000- 13% step time = 111.4 ms
P000: 14% step 0240:H0040b40-41 Day +00 20:00 2008-01-01 20:30:00: Rel.:073500: Active:73500 M:63957 S:08605 B:00938 D:000 O:00 N:0 Buffer:73500- 14% step time = 117.3 ms
P000: 14% step 0246:H0041b41-42 Day +00 20:30 2008-01-01 21:00:00: Rel.:073500: Active:73500 M:63933 S:08605 B:00962 D:000 O:00 N:0 Buffer:73500- 14% step time = 111.2 ms
P000: 15% step 0252:H0042b42-43 Day +00 21:00 2008-01-01 21:30:00: Rel.:077000: Active:77000 M:66759 S:09389 B:00852 D:000 O:00 N:0 Buffer:77000- 15% step time = 127.4 ms
P000: 15% step 0258:H0043b43-44 Day +00 21:30 2008-01-01 22:00:00: Rel.:077000: Active:77000 M:66780 S:09389 B:00831 D:000 O:00 N:0 Buffer:77000- 15% step time = 115.2 ms
P000: 15% step 0264:H0044b44-45 Day +00 22:00 2008-01-01 22:30:00: Rel.:080500: Active:80500 M:69710 S:09889 B:00901 D:000 O:00 N:0 Buffer:80500- 15% step time = 127.0 ms
P000: 16% step 0270:H0045b45-46 Day +00 22:30 2008-01-01 23:00:00: Rel.:080500: Active:80500 M:69673 S:09889 B:00938 D:000 O:00 N:0 Buffer:80500- 15% step time = 120.7 ms
P000: 16% step 0276:H0046b46-47 Day +00 23:00 2008-01-01 23:30:00: Rel.:084000: Active:84000 M:72653 S:10389 B:00958 D:000 O:00 N:0 Buffer:84000- 16% step time = 131.9 ms
P000:   - Reading-file-01  schism_marl20080101_00z_3D.nc, steps in file  48, steps  available 000:047, reading   1 of 48 steps,  for hydo-model time steps 47:47,  from file offsets 47:47,  into ring buffer offsets 047:047 
P000:   - Reading-file-02  schism_marl20080102_00z_3D.nc, steps in file  48, steps  available 048:095, reading  47 of 47 steps,  for hydo-model time steps 48:94,  from file offsets 00:46,  into ring buffer offsets 000:046 
P000:       -  read  48 time steps in  22.1 sec
P000: 16% step 0282:H0047b47-00 Day +00 23:30 2008-01-02 00:00:00: Rel.:084000: Active:84000 M:72711 S:10389 B:00900 D:000 O:00 N:0 Buffer:84000- 16% step time = 22220.0 ms
P000: 17% step 0288:H0048b00-01 Day +01 00:00 2008-01-02 00:30:00: Rel.:087500: Active:87500 M:75945 S:10569 B:00986 D:000 O:00 N:0 Buffer:87500- 17% step time = 143.6 ms
P000: 17% step 0294:H0049b01-02 Day +01 00:30 2008-01-02 01:00:00: Rel.:087500: Active:87500 M:78053 S:06318 B:03129 D:000 O:00 N:0 Buffer:87500- 17% step time = 136.6 ms
P000: 17% step 0300:H0050b02-03 Day +01 01:00 2008-01-02 01:30:00: Rel.:091000: Active:91000 M:83211 S:02945 B:04844 D:000 O:00 N:0 Buffer:91000- 17% step time = 156.1 ms
P000: 18% step 0306:H0051b03-04 Day +01 01:30 2008-01-02 02:00:00: Rel.:091000: Active:91000 M:83681 S:02725 B:04594 D:000 O:00 N:0 Buffer:91000- 17% step time = 149.4 ms
P000: 18% step 0312:H0052b04-05 Day +01 02:00 2008-01-02 02:30:00: Rel.:094500: Active:94500 M:86980 S:02717 B:04803 D:000 O:00 N:0 Buffer:94500- 18% step time = 161.3 ms
P000: 18% step 0318:H0053b05-06 Day +01 02:30 2008-01-02 03:00:00: Rel.:094500: Active:94500 M:87572 S:02187 B:04741 D:000 O:00 N:0 Buffer:94500- 18% step time = 157.8 ms
P000: 19% step 0324:H0054b06-07 Day +01 03:00 2008-01-02 03:30:00: Rel.:098000: Active:98000 M:90684 S:02164 B:05152 D:000 O:00 N:0 Buffer:98000- 19% step time = 176.7 ms
P000: 19% step 0330:H0055b07-08 Day +01 03:30 2008-01-02 04:00:00: Rel.:098000: Active:98000 M:91589 S:00084 B:06327 D:000 O:00 N:0 Buffer:98000- 19% step time = 165.7 ms
P000: 19% step 0336:H0056b08-09 Day +01 04:00 2008-01-02 04:30:00: Rel.:101500: Active:101500 M:94650 S:00072 B:06778 D:000 O:00 N:0 Buffer:101500- 19% step time = 177.7 ms
P000: 20% step 0342:H0057b09-10 Day +01 04:30 2008-01-02 05:00:00: Rel.:101500: Active:101500 M:94755 S:00072 B:06673 D:000 O:00 N:0 Buffer:101500- 19% step time = 171.5 ms
P000: 20% step 0348:H0058b10-11 Day +01 05:00 2008-01-02 05:30:00: Rel.:105000: Active:105000 M:97442 S:01287 B:06271 D:000 O:00 N:0 Buffer:105000- 20% step time = 183.9 ms
P000: 20% step 0354:H0059b11-12 Day +01 05:30 2008-01-02 06:00:00: Rel.:105000: Active:105000 M:96961 S:02562 B:05477 D:000 O:00 N:0 Buffer:105000- 20% step time = 172.9 ms
P000: 21% step 0360:H0060b12-13 Day +01 06:00 2008-01-02 06:30:00: Rel.:108500: Active:108500 M:100107 S:03046 B:05347 D:000 O:00 N:0 Buffer:108500- 21% step time = 192.0 ms
P000: 21% step 0366:H0061b13-14 Day +01 06:30 2008-01-02 07:00:00: Rel.:108500: Active:108500 M:99723 S:03579 B:05198 D:000 O:00 N:0 Buffer:108500- 21% step time = 179.1 ms
P000: 22% step 0372:H0062b14-15 Day +01 07:00 2008-01-02 07:30:00: Rel.:112000: Active:112000 M:102580 S:03843 B:05577 D:000 O:00 N:0 Buffer:112000- 21% step time = 190.7 ms
P000: 22% step 0378:H0063b15-16 Day +01 07:30 2008-01-02 08:00:00: Rel.:112000: Active:112000 M:102102 S:03996 B:05902 D:000 O:00 N:0 Buffer:112000- 21% step time = 183.0 ms
P000: 22% step 0384:H0064b16-17 Day +01 08:00 2008-01-02 08:30:00: Rel.:115500: Active:115500 M:104278 S:05647 B:05575 D:000 O:00 N:0 Buffer:115500- 22% step time = 193.4 ms
P000: 23% step 0390:H0065b17-18 Day +01 08:30 2008-01-02 09:00:00: Rel.:115500: Active:115500 M:102126 S:10312 B:03062 D:000 O:00 N:0 Buffer:115500- 22% step time = 181.9 ms
P000: 23% step 0396:H0066b18-19 Day +01 09:00 2008-01-02 09:30:00: Rel.:119000: Active:119000 M:105445 S:10872 B:02683 D:000 O:00 N:0 Buffer:119000- 23% step time = 201.8 ms
P000: 23% step 0402:H0067b19-20 Day +01 09:30 2008-01-02 10:00:00: Rel.:119000: Active:119000 M:105683 S:10872 B:02445 D:000 O:00 N:0 Buffer:119000- 23% step time = 185.6 ms
P000: 24% step 0408:H0068b20-21 Day +01 10:00 2008-01-02 10:30:00: Rel.:122500: Active:122500 M:108919 S:11372 B:02209 D:000 O:00 N:0 Buffer:122500- 23% step time = 198.0 ms
P000: 24% step 0414:H0069b21-22 Day +01 10:30 2008-01-02 11:00:00: Rel.:122500: Active:122500 M:108995 S:11372 B:02133 D:000 O:00 N:0 Buffer:122500- 23% step time = 191.6 ms
P000: 24% step 0420:H0070b22-23 Day +01 11:00 2008-01-02 11:30:00: Rel.:126000: Active:126000 M:111996 S:11872 B:02132 D:000 O:00 N:0 Buffer:126000- 24% step time = 204.2 ms
P000: 25% step 0426:H0071b23-24 Day +01 11:30 2008-01-02 12:00:00: Rel.:126000: Active:126000 M:111677 S:11872 B:02451 D:000 O:00 N:0 Buffer:126000- 24% step time = 196.6 ms
P000: 25% step 0432:H0072b24-25 Day +01 12:00 2008-01-02 12:30:00: Rel.:129500: Active:129500 M:114642 S:12372 B:02486 D:000 O:00 N:0 Buffer:129500- 25% step time = 217.7 ms
P000: 25% step 0438:H0073b25-26 Day +01 12:30 2008-01-02 13:00:00: Rel.:129500: Active:129500 M:114618 S:12372 B:02510 D:000 O:00 N:0 Buffer:129500- 25% step time = 202.4 ms
P000: 26% step 0444:H0074b26-27 Day +01 13:00 2008-01-02 13:30:00: Rel.:133000: Active:133000 M:117674 S:12872 B:02454 D:000 O:00 N:0 Buffer:133000- 25% step time = 214.6 ms
P000: 26% step 0450:H0075b27-28 Day +01 13:30 2008-01-02 14:00:00: Rel.:133000: Active:133000 M:120557 S:07447 B:04996 D:000 O:00 N:0 Buffer:133000- 25% step time = 214.3 ms
P000: 26% step 0456:H0076b28-29 Day +01 14:00 2008-01-02 14:30:00: Rel.:136500: Active:136500 M:125878 S:03995 B:06627 D:000 O:00 N:0 Buffer:136500- 26% step time = 232.3 ms
P000: 27% step 0462:H0077b29-30 Day +01 14:30 2008-01-02 15:00:00: Rel.:136500: Active:136500 M:126287 S:03663 B:06550 D:000 O:00 N:0 Buffer:136500- 26% step time = 224.6 ms
P000: 27% step 0468:H0078b30-31 Day +01 15:00 2008-01-02 15:30:00: Rel.:140000: Active:140000 M:129544 S:03579 B:06877 D:000 O:00 N:0 Buffer:140000- 27% step time = 245.4 ms
P000: 27% step 0474:H0079b31-32 Day +01 15:30 2008-01-02 16:00:00: Rel.:140000: Active:140000 M:130362 S:02717 B:06921 D:000 O:00 N:0 Buffer:140000- 27% step time = 231.8 ms
P000: 28% step 0480:H0080b32-33 Day +01 16:00 2008-01-02 16:30:00: Rel.:143500: Active:143500 M:133618 S:02562 B:07320 D:000 O:00 N:0 Buffer:143500- 27% step time = 243.8 ms
P000: 28% step 0486:H0081b33-34 Day +01 16:30 2008-01-02 17:00:00: Rel.:143500: Active:143500 M:133582 S:02559 B:07359 D:000 O:00 N:0 Buffer:143500- 27% step time = 237.6 ms
P000: 28% step 0492:H0082b34-35 Day +01 17:00 2008-01-02 17:30:00: Rel.:147000: Active:147000 M:137374 S:01287 B:08339 D:000 O:00 N:0 Buffer:147000- 28% step time = 251.4 ms
P000: 29% step 0498:H0083b35-36 Day +01 17:30 2008-01-02 18:00:00: Rel.:147000: Active:147000 M:136581 S:03208 B:07211 D:000 O:00 N:0 Buffer:147000- 28% step time = 241.9 ms
P000: 29% step 0504:H0084b36-37 Day +01 18:00 2008-01-02 18:30:00: Rel.:150500: Active:150500 M:139628 S:03210 B:07662 D:000 O:00 N:0 Buffer:150500- 29% step time = 263.2 ms
P000: 30% step 0510:H0085b37-38 Day +01 18:30 2008-01-02 19:00:00: Rel.:150500: Active:150500 M:139357 S:03764 B:07379 D:000 O:00 N:0 Buffer:150500- 29% step time = 247.3 ms
P000: 30% step 0516:H0086b38-39 Day +01 19:00 2008-01-02 19:30:00: Rel.:154000: Active:154000 M:142730 S:04044 B:07226 D:000 O:00 N:0 Buffer:154000- 29% step time = 259.9 ms
P000: 30% step 0522:H0087b39-40 Day +01 19:30 2008-01-02 20:00:00: Rel.:154000: Active:154000 M:142412 S:04433 B:07155 D:000 O:00 N:0 Buffer:154000- 29% step time = 251.4 ms
P000: 31% step 0528:H0088b40-41 Day +01 20:00 2008-01-02 20:30:00: Rel.:157500: Active:157500 M:145233 S:04826 B:07441 D:000 O:00 N:0 Buffer:157500- 30% step time = 263.9 ms
P000: 31% step 0534:H0089b41-42 Day +01 20:30 2008-01-02 21:00:00: Rel.:157500: Active:157500 M:144260 S:06421 B:06819 D:000 O:00 N:0 Buffer:157500- 30% step time = 256.2 ms
P000: 31% step 0540:H0090b42-43 Day +01 21:00 2008-01-02 21:30:00: Rel.:161000: Active:161000 M:146244 S:08497 B:06259 D:000 O:00 N:0 Buffer:161000- 31% step time = 273.8 ms
P000: 32% step 0546:H0091b43-44 Day +01 21:30 2008-01-02 22:00:00: Rel.:161000: Active:161000 M:143282 S:13029 B:04689 D:000 O:00 N:0 Buffer:161000- 31% step time = 253.4 ms
P000: 32% step 0552:H0092b44-45 Day +01 22:00 2008-01-02 22:30:00: Rel.:164500: Active:164500 M:146241 S:13529 B:04730 D:000 O:00 N:0 Buffer:164500- 31% step time = 264.1 ms
P000: 32% step 0558:H0093b45-46 Day +01 22:30 2008-01-02 23:00:00: Rel.:164500: Active:164500 M:145727 S:13884 B:04889 D:000 O:00 N:0 Buffer:164500- 31% step time = 258.2 ms
P000:   - Reading-file-02  schism_marl20080102_00z_3D.nc, steps in file  48, steps  available 048:095, reading   2 of 48 steps,  for hydo-model time steps 94:95,  from file offsets 46:47,  into ring buffer offsets 046:047 
P000:   - Reading-file-03  schism_marl20080103_00z_3D.nc, steps in file  48, steps  available 096:143, reading  46 of 46 steps,  for hydo-model time steps 96:141,  from file offsets 00:45,  into ring buffer offsets 000:045 
P000:       -  read  48 time steps in  22.0 sec
P000: 33% step 0564:H0094b46-47 Day +01 23:00 2008-01-02 23:30:00: Rel.:168000: Active:168000 M:148562 S:14384 B:05054 D:000 O:00 N:0 Buffer:168000- 32% step time = 22232.8 ms
P000: 33% step 0570:H0095b47-00 Day +01 23:30 2008-01-03 00:00:00: Rel.:168000: Active:168000 M:148515 S:14384 B:05101 D:000 O:00 N:0 Buffer:168000- 32% step time = 264.0 ms
P000: 33% step 0576:H0096b00-01 Day +02 00:00 2008-01-03 00:30:00: Rel.:171500: Active:171500 M:151349 S:14884 B:05267 D:000 O:00 N:0 Buffer:171500- 33% step time = 280.2 ms
P000: 34% step 0582:H0097b01-02 Day +02 00:30 2008-01-03 01:00:00: Rel.:171500: Active:171500 M:151348 S:14884 B:05268 D:000 O:00 N:0 Buffer:171500- 33% step time = 270.2 ms
P000: 34% step 0588:H0098b02-03 Day +02 01:00 2008-01-03 01:30:00: Rel.:175000: Active:175000 M:156535 S:10851 B:07614 D:000 O:00 N:0 Buffer:175000- 33% step time = 284.5 ms
P000: 34% step 0594:H0099b03-04 Day +02 01:30 2008-01-03 02:00:00: Rel.:175000: Active:175000 M:158011 S:08926 B:08063 D:000 O:00 N:0 Buffer:175000- 33% step time = 281.1 ms
P000: 35% step 0600:H0100b04-05 Day +02 02:00 2008-01-03 02:30:00: Rel.:178500: Active:178500 M:163674 S:04827 B:09999 D:000 O:00 N:0 Buffer:178500- 34% step time = 305.8 ms
P000: 35% step 0606:H0101b05-06 Day +02 02:30 2008-01-03 03:00:00: Rel.:178500: Active:178500 M:164824 S:04433 B:09243 D:000 O:00 N:0 Buffer:178500- 34% step time = 309.0 ms
P000: 35% step 0612:H0102b06-07 Day +02 03:00 2008-01-03 03:30:00: Rel.:182000: Active:182000 M:168383 S:04044 B:09573 D:000 O:00 N:0 Buffer:182000- 35% step time = 315.1 ms
P000: 36% step 0618:H0103b07-08 Day +02 03:30 2008-01-03 04:00:00: Rel.:182000: Active:182000 M:168848 S:03570 B:09582 D:000 O:00 N:0 Buffer:182000- 35% step time = 301.8 ms
P000: 36% step 0624:H0104b08-09 Day +02 04:00 2008-01-03 04:30:00: Rel.:185500: Active:185500 M:172455 S:03210 B:09835 D:000 O:00 N:0 Buffer:185500- 35% step time = 319.9 ms
P000: 36% step 0630:H0105b09-10 Day +02 04:30 2008-01-03 05:00:00: Rel.:185500: Active:185500 M:172535 S:03208 B:09757 D:000 O:00 N:0 Buffer:185500- 35% step time = 322.3 ms
P000: 37% step 0636:H0106b10-11 Day +02 05:00 2008-01-03 05:30:00: Rel.:189000: Active:189000 M:176931 S:01287 B:10782 D:000 O:00 N:0 Buffer:189000- 36% step time = 328.9 ms
P000: 37% step 0642:H0107b11-12 Day +02 05:30 2008-01-03 06:00:00: Rel.:189000: Active:189000 M:176347 S:02702 B:09951 D:000 O:00 N:0 Buffer:189000- 36% step time = 313.1 ms
P000: 38% step 0648:H0108b12-13 Day +02 06:00 2008-01-03 06:30:00: Rel.:192500: Active:192500 M:179703 S:02729 B:10068 D:000 O:00 N:0 Buffer:192500- 37% step time = 335.5 ms
P000: 38% step 0654:H0109b13-14 Day +02 06:30 2008-01-03 07:00:00: Rel.:192500: Active:192500 M:179900 S:02954 B:09646 D:000 O:00 N:0 Buffer:192500- 37% step time = 316.7 ms
P000: 38% step 0660:H0110b14-15 Day +02 07:00 2008-01-03 07:30:00: Rel.:196000: Active:196000 M:177880 S:10655 B:07465 D:000 O:00 N:0 Buffer:196000- 37% step time = 321.8 ms
P000: 39% step 0666:H0111b15-16 Day +02 07:30 2008-01-03 08:00:00: Rel.:196000: Active:196000 M:177976 S:10683 B:07341 D:000 O:00 N:0 Buffer:196000- 37% step time = 315.8 ms
P000: 39% step 0672:H0112b16-17 Day +02 08:00 2008-01-03 08:30:00: Rel.:199500: Active:199500 M:176469 S:16838 B:06193 D:000 O:00 N:0 Buffer:199500- 38% step time = 333.9 ms
P000: 39% step 0678:H0113b17-18 Day +02 08:30 2008-01-03 09:00:00: Rel.:199500: Active:199500 M:176332 S:17455 B:05713 D:000 O:00 N:0 Buffer:199500- 38% step time = 312.1 ms
P000: 40% step 0684:H0114b18-19 Day +02 09:00 2008-01-03 09:30:00: Rel.:203000: Active:203000 M:179239 S:18255 B:05506 D:000 O:00 N:0 Buffer:203000- 39% step time = 335.4 ms
P000: 40% step 0690:H0115b19-20 Day +02 09:30 2008-01-03 10:00:00: Rel.:203000: Active:203000 M:178383 S:19381 B:05236 D:000 O:00 N:0 Buffer:203000- 39% step time = 317.1 ms
P000: 40% step 0696:H0116b20-21 Day +02 10:00 2008-01-03 10:30:00: Rel.:206500: Active:206500 M:181323 S:19882 B:05295 D:000 O:00 N:0 Buffer:206500- 40% step time = 325.6 ms
P000: 41% step 0702:H0117b21-22 Day +02 10:30 2008-01-03 11:00:00: Rel.:206500: Active:206500 M:181346 S:19882 B:05272 D:000 O:00 N:0 Buffer:206500- 40% step time = 322.8 ms
P000: 41% step 0708:H0118b22-23 Day +02 11:00 2008-01-03 11:30:00: Rel.:210000: Active:210000 M:184534 S:20382 B:05084 D:000 O:00 N:0 Buffer:210000- 40% step time = 333.0 ms
P000: 41% step 0714:H0119b23-24 Day +02 11:30 2008-01-03 12:00:00: Rel.:210000: Active:210000 M:184622 S:20382 B:04996 D:000 O:00 N:0 Buffer:210000- 40% step time = 326.3 ms
P000: 42% step 0720:H0120b24-25 Day +02 12:00 2008-01-03 12:30:00: Rel.:213500: Active:213500 M:187760 S:20882 B:04858 D:000 O:00 N:0 Buffer:213500- 41% step time = 350.2 ms
P000: 42% step 0726:H0121b25-26 Day +02 12:30 2008-01-03 13:00:00: Rel.:213500: Active:213500 M:187721 S:20882 B:04897 D:000 O:00 N:0 Buffer:213500- 41% step time = 333.1 ms
P000: 42% step 0732:H0122b26-27 Day +02 13:00 2008-01-03 13:30:00: Rel.:217000: Active:217000 M:190669 S:21382 B:04949 D:000 O:00 N:0 Buffer:217000- 42% step time = 341.5 ms
P000: 43% step 0738:H0123b27-28 Day +02 13:30 2008-01-03 14:00:00: Rel.:217000: Active:217000 M:190820 S:21381 B:04799 D:000 O:00 N:0 Buffer:217000- 42% step time = 338.8 ms
P000: 43% step 0744:H0124b28-29 Day +02 14:00 2008-01-03 14:30:00: Rel.:220500: Active:220500 M:194605 S:20792 B:05103 D:000 O:00 N:0 Buffer:220500- 42% step time = 349.7 ms
P000: 43% step 0750:H0125b29-30 Day +02 14:30 2008-01-03 15:00:00: Rel.:220500: Active:220500 M:194542 S:20455 B:05503 D:000 O:00 N:0 Buffer:220500- 42% step time = 344.4 ms
P000: 44% step 0756:H0126b30-31 Day +02 15:00 2008-01-03 15:30:00: Rel.:224000: Active:224000 M:200447 S:16365 B:07188 D:000 O:00 N:0 Buffer:224000- 43% step time = 373.9 ms
P000: 44% step 0762:H0127b31-32 Day +02 15:30 2008-01-03 16:00:00: Rel.:224000: Active:224000 M:203886 S:10671 B:09443 D:000 O:00 N:0 Buffer:224000- 43% step time = 361.5 ms
P000: 44% step 0768:H0128b32-33 Day +02 16:00 2008-01-03 16:30:00: Rel.:227500: Active:227500 M:210709 S:06385 B:10406 D:000 O:00 N:0 Buffer:227500- 44% step time = 383.4 ms
P000: 45% step 0774:H0129b33-34 Day +02 16:30 2008-01-03 17:00:00: Rel.:227500: Active:227500 M:213213 S:02729 B:11558 D:000 O:00 N:0 Buffer:227500- 44% step time = 378.2 ms
P000: 45% step 0780:H0130b34-35 Day +02 17:00 2008-01-03 17:30:00: Rel.:231000: Active:231000 M:217773 S:01287 B:11940 D:000 O:00 N:0 Buffer:231000- 44% step time = 399.1 ms
P000: 45% step 0786:H0131b35-36 Day +02 17:30 2008-01-03 18:00:00: Rel.:231000: Active:231000 M:218803 S:00217 B:11980 D:000 O:00 N:0 Buffer:231000- 44% step time = 385.5 ms
P000: 46% step 0792:H0132b36-37 Day +02 18:00 2008-01-03 18:30:00: Rel.:234500: Active:234500 M:222449 S:00072 B:11979 D:000 O:00 N:0 Buffer:234500- 45% step time = 413.1 ms
P000: 46% step 0798:H0133b37-38 Day +02 18:30 2008-01-03 19:00:00: Rel.:234500: Active:234500 M:222832 S:00615 B:11053 D:000 O:00 N:0 Buffer:234500- 45% step time = 391.0 ms
P000: 47% step 0804:H0134b38-39 Day +02 19:00 2008-01-03 19:30:00: Rel.:238000: Active:238000 M:224706 S:03646 B:09648 D:000 O:00 N:0 Buffer:238000- 46% step time = 400.1 ms
P000: 47% step 0810:H0135b39-40 Day +02 19:30 2008-01-03 20:00:00: Rel.:238000: Active:238000 M:224893 S:03792 B:09315 D:000 O:00 N:0 Buffer:238000- 46% step time = 400.7 ms
P000: 47% step 0816:H0136b40-41 Day +02 20:00 2008-01-03 20:30:00: Rel.:241500: Active:241500 M:227721 S:04485 B:09294 D:000 O:00 N:0 Buffer:241500- 46% step time = 405.4 ms
P000: 48% step 0822:H0137b41-42 Day +02 20:30 2008-01-03 21:00:00: Rel.:241500: Active:241500 M:228093 S:05070 B:08337 D:000 O:00 N:0 Buffer:241500- 46% step time = 398.8 ms
P000: 48% step 0828:H0138b42-43 Day +02 21:00 2008-01-03 21:30:00: Rel.:245000: Active:245000 M:231886 S:05749 B:07365 D:000 O:00 N:0 Buffer:245000- 47% step time = 424.0 ms
P000: 48% step 0834:H0139b43-44 Day +02 21:30 2008-01-03 22:00:00: Rel.:245000: Active:245000 M:231682 S:06799 B:06519 D:000 O:00 N:0 Buffer:245000- 47% step time = 403.7 ms
P000: 49% step 0840:H0140b44-45 Day +02 22:00 2008-01-03 22:30:00: Rel.:248500: Active:248500 M:231794 S:11078 B:05628 D:000 O:00 N:0 Buffer:248500- 48% step time = 409.6 ms
P000:   - Reading-file-03  schism_marl20080103_00z_3D.nc, steps in file  48, steps  available 096:143, reading   3 of 48 steps,  for hydo-model time steps 141:143,  from file offsets 45:47,  into ring buffer offsets 045:047 
P000:   - Reading-file-04  schism_marl20080104_00z_3D.nc, steps in file  48, steps  available 144:191, reading  45 of 45 steps,  for hydo-model time steps 144:188,  from file offsets 00:44,  into ring buffer offsets 000:044 
P000:       -  read  48 time steps in  21.9 sec
P000: 49% step 0846:H0141b45-46 Day +02 22:30 2008-01-03 23:00:00: Rel.:248500: Active:248500 M:229765 S:13808 B:04927 D:000 O:00 N:0 Buffer:248500- 48% step time = 22335.3 ms
P000: 49% step 0852:H0142b46-47 Day +02 23:00 2008-01-03 23:30:00: Rel.:252000: Active:252000 M:232453 S:14314 B:05233 D:000 O:00 N:0 Buffer:252000- 48% step time = 409.9 ms
P000: 50% step 0858:H0143b47-00 Day +02 23:30 2008-01-04 00:00:00: Rel.:252000: Active:252000 M:232425 S:14319 B:05256 D:000 O:00 N:0 Buffer:252000- 48% step time = 405.5 ms
P000: 50% step 0864:H0144b00-01 Day +03 00:00 2008-01-04 00:30:00: Rel.:255500: Active:255500 M:235043 S:14822 B:05635 D:000 O:00 N:0 Buffer:255500- 49% step time = 431.6 ms
P000: 50% step 0870:H0145b01-02 Day +03 00:30 2008-01-04 01:00:00: Rel.:255500: Active:255500 M:234910 S:14819 B:05771 D:000 O:00 N:0 Buffer:255500- 49% step time = 411.3 ms
P000: 51% step 0876:H0146b02-03 Day +03 01:00 2008-01-04 01:30:00: Rel.:259000: Active:259000 M:237516 S:15319 B:06165 D:000 O:00 N:0 Buffer:259000- 50% step time = 422.7 ms
P000: 51% step 0882:H0147b03-04 Day +03 01:30 2008-01-04 02:00:00: Rel.:259000: Active:259000 M:237443 S:15314 B:06243 D:000 O:00 N:0 Buffer:259000- 50% step time = 415.0 ms
P000: 51% step 0888:H0148b04-05 Day +03 02:00 2008-01-04 02:30:00: Rel.:262500: Active:262500 M:241406 S:13088 B:08006 D:000 O:00 N:0 Buffer:262500- 50% step time = 431.7 ms
P000: 52% step 0894:H0149b05-06 Day +03 02:30 2008-01-04 03:00:00: Rel.:262500: Active:262500 M:245471 S:06799 B:10230 D:000 O:00 N:0 Buffer:262500- 50% step time = 435.5 ms
P000: 52% step 0900:H0150b06-07 Day +03 03:00 2008-01-04 03:30:00: Rel.:266000: Active:266000 M:249284 S:05760 B:10956 D:000 O:00 N:0 Buffer:266000- 51% step time = 464.5 ms
P000: 52% step 0906:H0151b07-08 Day +03 03:30 2008-01-04 04:00:00: Rel.:266000: Active:266000 M:249880 S:05070 B:11050 D:000 O:00 N:0 Buffer:266000- 51% remaining: 0 days 0 hrs 4 min, step time = 442.9 ms
P000: 53% step 0912:H0152b08-09 Day +03 04:00 2008-01-04 04:30:00: Rel.:269500: Active:269500 M:253009 S:04485 B:12006 D:000 O:00 N:0 Buffer:269500- 52% remaining: 0 days 0 hrs 4 min, step time = 457.7 ms
P000: 53% step 0918:H0153b09-10 Day +03 04:30 2008-01-04 05:00:00: Rel.:269500: Active:269500 M:253505 S:03792 B:12203 D:000 O:00 N:0 Buffer:269500- 52% remaining: 0 days 0 hrs 4 min, step time = 451.9 ms
P000: 53% step 0924:H0154b10-11 Day +03 05:00 2008-01-04 05:30:00: Rel.:273000: Active:273000 M:256963 S:03646 B:12391 D:000 O:00 N:0 Buffer:273000- 52% remaining: 0 days 0 hrs 4 min, step time = 465.9 ms
P000: 54% step 0930:H0155b11-12 Day +03 05:30 2008-01-04 06:00:00: Rel.:273000: Active:273000 M:258919 S:00171 B:13910 D:000 O:00 N:0 Buffer:273000- 52% remaining: 0 days 0 hrs 4 min, step time = 459.1 ms
P000: 54% step 0936:H0156b12-13 Day +03 06:00 2008-01-04 06:30:00: Rel.:276500: Active:276500 M:262191 S:00072 B:14237 D:000 O:00 N:0 Buffer:276500- 53% remaining: 0 days 0 hrs 4 min, step time = 488.0 ms
P000: 55% step 0942:H0157b13-14 Day +03 06:30 2008-01-04 07:00:00: Rel.:276500: Active:276500 M:262265 S:00072 B:14163 D:000 O:00 N:0 Buffer:276500- 53% remaining: 0 days 0 hrs 4 min, step time = 483.5 ms
P000: 55% step 0948:H0158b14-15 Day +03 07:00 2008-01-04 07:30:00: Rel.:280000: Active:280000 M:265225 S:00638 B:14137 D:000 O:00 N:0 Buffer:280000- 54% remaining: 0 days 0 hrs 4 min, step time = 481.9 ms
P000: 55% step 0954:H0159b15-16 Day +03 07:30 2008-01-04 08:00:00: Rel.:280000: Active:280000 M:263803 S:03232 B:12965 D:000 O:00 N:0 Buffer:280000- 54% remaining: 0 days 0 hrs 4 min, step time = 482.6 ms
P000: 56% step 0960:H0160b16-17 Day +03 08:00 2008-01-04 08:30:00: Rel.:283500: Active:283500 M:267020 S:03450 B:13030 D:000 O:00 N:0 Buffer:283500- 54% remaining: 0 days 0 hrs 4 min, step time = 484.3 ms
P000: 56% step 0966:H0161b17-18 Day +03 08:30 2008-01-04 09:00:00: Rel.:283500: Active:283500 M:266877 S:03614 B:13009 D:000 O:00 N:0 Buffer:283500- 54% remaining: 0 days 0 hrs 4 min, step time = 476.0 ms
P000: 56% step 0972:H0162b18-19 Day +03 09:00 2008-01-04 09:30:00: Rel.:287000: Active:287000 M:270643 S:03883 B:12474 D:000 O:00 N:0 Buffer:287000- 55% remaining: 0 days 0 hrs 4 min, step time = 507.3 ms
P000: 57% step 0978:H0163b19-20 Day +03 09:30 2008-01-04 10:00:00: Rel.:287000: Active:287000 M:269341 S:06432 B:11227 D:000 O:00 N:0 Buffer:287000- 55% remaining: 0 days 0 hrs 4 min, step time = 487.6 ms
P000: 57% step 0984:H0164b20-21 Day +03 10:00 2008-01-04 10:30:00: Rel.:290500: Active:290500 M:267590 S:13290 B:09620 D:000 O:00 N:0 Buffer:290500- 56% remaining: 0 days 0 hrs 4 min, step time = 488.4 ms
P000: 57% step 0990:H0165b21-22 Day +03 10:30 2008-01-04 11:00:00: Rel.:290500: Active:290500 M:266950 S:14064 B:09486 D:000 O:00 N:0 Buffer:290500- 56% remaining: 0 days 0 hrs 4 min, step time = 489.0 ms
P000: 58% step 0996:H0166b22-23 Day +03 11:00 2008-01-04 11:30:00: Rel.:294000: Active:294000 M:269885 S:14666 B:09449 D:000 O:00 N:0 Buffer:294000- 56% remaining: 0 days 0 hrs 4 min, step time = 484.1 ms
P000: 58% step 1002:H0167b23-24 Day +03 11:30 2008-01-04 12:00:00: Rel.:294000: Active:294000 M:269202 S:15274 B:09524 D:000 O:00 N:0 Buffer:294000- 56% remaining: 0 days 0 hrs 4 min, step time = 477.0 ms
P000: 58% step 1008:H0168b24-25 Day +03 12:00 2008-01-04 12:30:00: Rel.:297500: Active:297500 M:272352 S:15776 B:09372 D:000 O:00 N:0 Buffer:297500- 57% remaining: 0 days 0 hrs 4 min, step time = 502.5 ms
P000: 59% step 1014:H0169b25-26 Day +03 12:30 2008-01-04 13:00:00: Rel.:297500: Active:297500 M:272169 S:15776 B:09555 D:000 O:00 N:0 Buffer:297500- 57% remaining: 0 days 0 hrs 4 min, step time = 483.0 ms
P000: 59% step 1020:H0170b26-27 Day +03 13:00 2008-01-04 13:30:00: Rel.:301000: Active:301000 M:275169 S:16275 B:09556 D:000 O:00 N:0 Buffer:301000- 58% remaining: 0 days 0 hrs 4 min, step time = 507.1 ms
P000: 59% step 1026:H0171b27-28 Day +03 13:30 2008-01-04 14:00:00: Rel.:301000: Active:301000 M:275053 S:16274 B:09673 D:000 O:00 N:0 Buffer:301000- 58% remaining: 0 days 0 hrs 4 min, step time = 486.8 ms
P000: 60% step 1032:H0172b28-29 Day +03 14:00 2008-01-04 14:30:00: Rel.:304500: Active:304500 M:278116 S:16757 B:09627 D:000 O:00 N:0 Buffer:304500- 58% remaining: 0 days 0 hrs 4 min, step time = 499.7 ms
P000: 60% step 1038:H0173b29-30 Day +03 14:30 2008-01-04 15:00:00: Rel.:304500: Active:304500 M:278030 S:16650 B:09820 D:000 O:00 N:0 Buffer:304500- 58% remaining: 0 days 0 hrs 4 min, step time = 499.4 ms
P000: 60% step 1044:H0174b30-31 Day +03 15:00 2008-01-04 15:30:00: Rel.:308000: Active:308000 M:284132 S:11507 B:12361 D:000 O:00 N:0 Buffer:308000- 59% remaining: 0 days 0 hrs 4 min, step time = 526.0 ms
P000: 61% step 1050:H0175b31-32 Day +03 15:30 2008-01-04 16:00:00: Rel.:308000: Active:308000 M:287723 S:04596 B:15681 D:000 O:00 N:0 Buffer:308000- 59% remaining: 0 days 0 hrs 4 min, step time = 514.6 ms
P000: 61% step 1056:H0176b32-33 Day +03 16:00 2008-01-04 16:30:00: Rel.:311500: Active:311500 M:292105 S:03851 B:15544 D:000 O:00 N:0 Buffer:311500- 60% remaining: 0 days 0 hrs 3 min, step time = 528.7 ms
P000: 61% step 1062:H0177b33-34 Day +03 16:30 2008-01-04 17:00:00: Rel.:311500: Active:311500 M:292071 S:03615 B:15814 D:000 O:00 N:0 Buffer:311500- 60% remaining: 0 days 0 hrs 3 min, step time = 522.7 ms
P000: 62% step 1068:H0178b34-35 Day +03 17:00 2008-01-04 17:30:00: Rel.:315000: Active:315000 M:296017 S:03283 B:15700 D:000 O:00 N:0 Buffer:315000- 60% remaining: 0 days 0 hrs 3 min, step time = 532.9 ms
P000: 62% step 1074:H0179b35-36 Day +03 17:30 2008-01-04 18:00:00: Rel.:315000: Active:315000 M:296258 S:03232 B:15510 D:000 O:00 N:0 Buffer:315000- 60% remaining: 0 days 0 hrs 3 min, step time = 526.1 ms
P000: 62% step 1080:H0180b36-37 Day +03 18:00 2008-01-04 18:30:00: Rel.:318500: Active:318500 M:301291 S:00073 B:17136 D:000 O:00 N:0 Buffer:318500- 61% remaining: 0 days 0 hrs 3 min, step time = 556.6 ms
P000: 63% step 1086:H0181b37-38 Day +03 18:30 2008-01-04 19:00:00: Rel.:318500: Active:318500 M:301299 S:00072 B:17129 D:000 O:00 N:0 Buffer:318500- 61% remaining: 0 days 0 hrs 3 min, step time = 533.1 ms
P000: 63% step 1092:H0182b38-39 Day +03 19:00 2008-01-04 19:30:00: Rel.:322000: Active:322000 M:304390 S:00072 B:17538 D:000 O:00 N:0 Buffer:322000- 62% remaining: 0 days 0 hrs 3 min, step time = 549.3 ms
P000: 64% step 1098:H0183b39-40 Day +03 19:30 2008-01-04 20:00:00: Rel.:322000: Active:322000 M:304210 S:00665 B:17125 D:000 O:00 N:0 Buffer:322000- 62% remaining: 0 days 0 hrs 3 min, step time = 542.0 ms
P000: 64% step 1104:H0184b40-41 Day +03 20:00 2008-01-04 20:30:00: Rel.:325500: Active:325500 M:307479 S:01155 B:16866 D:000 O:00 N:0 Buffer:325500- 62% remaining: 0 days 0 hrs 3 min, step time = 554.4 ms
P000: 64% step 1110:H0185b41-42 Day +03 20:30 2008-01-04 21:00:00: Rel.:325500: Active:325500 M:306310 S:02956 B:16234 D:000 O:00 N:0 Buffer:325500- 62% remaining: 0 days 0 hrs 3 min, step time = 545.9 ms
P000: 65% step 1116:H0186b42-43 Day +03 21:00 2008-01-04 21:30:00: Rel.:329000: Active:329000 M:309660 S:03225 B:16115 D:000 O:00 N:0 Buffer:329000- 63% remaining: 0 days 0 hrs 3 min, step time = 571.3 ms
P000: 65% step 1122:H0187b43-44 Day +03 21:30 2008-01-04 22:00:00: Rel.:329000: Active:329000 M:309511 S:03280 B:16209 D:000 O:00 N:0 Buffer:329000- 63% remaining: 0 days 0 hrs 3 min, step time = 554.7 ms
P000:   - Reading-file-04  schism_marl20080104_00z_3D.nc, steps in file  48, steps  available 144:191, reading   4 of 48 steps,  for hydo-model time steps 188:191,  from file offsets 44:47,  into ring buffer offsets 044:047 
P000:   - Reading-file-05  schism_marl20080105_00z_3D.nc, steps in file  48, steps  available 192:239, reading  44 of 44 steps,  for hydo-model time steps 192:235,  from file offsets 00:43,  into ring buffer offsets 000:043 
P000:       -  read  48 time steps in  22.0 sec
P000: 65% step 1128:H0188b44-45 Day +03 22:00 2008-01-04 22:30:00: Rel.:332500: Active:332500 M:312596 S:03645 B:16259 D:000 O:00 N:0 Buffer:332500- 64% remaining: 0 days 0 hrs 3 min, step time = 22576.5 ms
P000: 66% step 1134:H0189b45-46 Day +03 22:30 2008-01-04 23:00:00: Rel.:332500: Active:332500 M:311303 S:05430 B:15767 D:000 O:00 N:0 Buffer:332500- 64% remaining: 0 days 0 hrs 3 min, step time = 552.9 ms
P000: 66% step 1140:H0190b46-47 Day +03 23:00 2008-01-04 23:30:00: Rel.:336000: Active:336000 M:310043 S:11545 B:14412 D:000 O:00 N:0 Buffer:336000- 64% remaining: 0 days 0 hrs 3 min, step time = 560.7 ms
P000: 66% step 1146:H0191b47-00 Day +03 23:30 2008-01-05 00:00:00: Rel.:336000: Active:336000 M:304951 S:19535 B:11514 D:000 O:00 N:0 Buffer:336000- 64% remaining: 0 days 0 hrs 3 min, step time = 543.7 ms
P000: 67% step 1152:H0192b00-01 Day +04 00:00 2008-01-05 00:30:00: Rel.:339500: Active:339500 M:307764 S:20109 B:11627 D:000 O:00 N:0 Buffer:339500- 65% remaining: 0 days 0 hrs 3 min, step time = 568.4 ms
P000: 67% step 1158:H0193b01-02 Day +04 00:30 2008-01-05 01:00:00: Rel.:339500: Active:339500 M:307046 S:20825 B:11629 D:000 O:00 N:0 Buffer:339500- 65% remaining: 0 days 0 hrs 3 min, step time = 541.7 ms
P000: 67% step 1164:H0194b02-03 Day +04 01:00 2008-01-05 01:30:00: Rel.:343000: Active:343000 M:310088 S:21330 B:11582 D:000 O:00 N:0 Buffer:343000- 66% remaining: 0 days 0 hrs 3 min, step time = 554.1 ms
P000: 68% step 1170:H0195b03-04 Day +04 01:30 2008-01-05 02:00:00: Rel.:343000: Active:343000 M:309881 S:21330 B:11789 D:000 O:00 N:0 Buffer:343000- 66% remaining: 0 days 0 hrs 3 min, step time = 548.5 ms
P000: 68% step 1176:H0196b04-05 Day +04 02:00 2008-01-05 02:30:00: Rel.:346500: Active:346500 M:313044 S:21820 B:11636 D:000 O:00 N:0 Buffer:346500- 66% remaining: 0 days 0 hrs 3 min, step time = 559.0 ms
P000: 68% step 1182:H0197b05-06 Day +04 02:30 2008-01-05 03:00:00: Rel.:346500: Active:346500 M:312972 S:21753 B:11775 D:000 O:00 N:0 Buffer:346500- 66% remaining: 0 days 0 hrs 3 min, step time = 555.8 ms
P000: 69% step 1188:H0198b06-07 Day +04 03:00 2008-01-05 03:30:00: Rel.:350000: Active:350000 M:321194 S:13578 B:15228 D:000 O:00 N:0 Buffer:350000- 67% remaining: 0 days 0 hrs 3 min, step time = 595.8 ms
P000: 69% step 1194:H0199b07-08 Day +04 03:30 2008-01-05 04:00:00: Rel.:350000: Active:350000 M:324916 S:05459 B:19625 D:000 O:00 N:0 Buffer:350000- 67% remaining: 0 days 0 hrs 3 min, step time = 584.4 ms
P000: 69% step 1200:H0200b08-09 Day +04 04:00 2008-01-05 04:30:00: Rel.:353500: Active:353500 M:329918 S:03670 B:19912 D:000 O:00 N:0 Buffer:353500- 68% remaining: 0 days 0 hrs 3 min, step time = 601.7 ms
P000: 70% step 1206:H0201b09-10 Day +04 04:30 2008-01-05 05:00:00: Rel.:353500: Active:353500 M:329619 S:03538 B:20343 D:000 O:00 N:0 Buffer:353500- 68% remaining: 0 days 0 hrs 3 min, step time = 593.5 ms
P000: 70% step 1212:H0202b10-11 Day +04 05:00 2008-01-05 05:30:00: Rel.:357000: Active:357000 M:333037 S:03277 B:20686 D:000 O:00 N:0 Buffer:357000- 68% remaining: 0 days 0 hrs 3 min, step time = 604.8 ms
P000: 70% step 1218:H0203b11-12 Day +04 05:30 2008-01-05 06:00:00: Rel.:357000: Active:357000 M:332864 S:02995 B:21141 D:000 O:00 N:0 Buffer:357000- 68% remaining: 0 days 0 hrs 3 min, step time = 598.8 ms
P000: 71% step 1224:H0204b12-13 Day +04 06:00 2008-01-05 06:30:00: Rel.:360500: Active:360500 M:336465 S:02952 B:21083 D:000 O:00 N:0 Buffer:360500- 69% remaining: 0 days 0 hrs 3 min, step time = 630.1 ms
P000: 71% step 1230:H0205b13-14 Day +04 06:30 2008-01-05 07:00:00: Rel.:360500: Active:360500 M:336238 S:01232 B:23030 D:000 O:00 N:0 Buffer:360500- 69% remaining: 0 days 0 hrs 3 min, step time = 610.0 ms
P000: 72% step 1236:H0206b14-15 Day +04 07:00 2008-01-05 07:30:00: Rel.:364000: Active:364000 M:339635 S:01155 B:23210 D:000 O:00 N:0 Buffer:364000- 70% remaining: 0 days 0 hrs 3 min, step time = 623.5 ms
P000: 72% step 1242:H0207b15-16 Day +04 07:30 2008-01-05 08:00:00: Rel.:364000: Active:364000 M:340261 S:01162 B:22577 D:000 O:00 N:0 Buffer:364000- 70% remaining: 0 days 0 hrs 3 min, step time = 614.4 ms
P000: 72% step 1248:H0208b16-17 Day +04 08:00 2008-01-05 08:30:00: Rel.:367500: Active:367500 M:341895 S:05059 B:20546 D:000 O:00 N:0 Buffer:367500- 70% remaining: 0 days 0 hrs 3 min, step time = 622.7 ms
P000: 73% step 1254:H0209b17-18 Day +04 08:30 2008-01-05 09:00:00: Rel.:367500: Active:367500 M:341934 S:05419 B:20147 D:000 O:00 N:0 Buffer:367500- 70% remaining: 0 days 0 hrs 3 min, step time = 621.9 ms
P000: 73% step 1260:H0210b18-19 Day +04 09:00 2008-01-05 09:30:00: Rel.:371000: Active:371000 M:344529 S:07434 B:19037 D:000 O:00 N:0 Buffer:371000- 71% remaining: 0 days 0 hrs 3 min, step time = 643.2 ms
P000: 73% step 1266:H0211b19-20 Day +04 09:30 2008-01-05 10:00:00: Rel.:371000: Active:371000 M:340163 S:13888 B:16949 D:000 O:00 N:0 Buffer:371000- 71% remaining: 0 days 0 hrs 3 min, step time = 612.9 ms
P000: 74% step 1272:H0212b20-21 Day +04 10:00 2008-01-05 10:30:00: Rel.:374500: Active:374500 M:341570 S:15653 B:17277 D:000 O:00 N:0 Buffer:374500- 72% remaining: 0 days 0 hrs 3 min, step time = 616.8 ms
P000: 74% step 1278:H0213b21-22 Day +04 10:30 2008-01-05 11:00:00: Rel.:374500: Active:374500 M:340529 S:17641 B:16330 D:000 O:00 N:0 Buffer:374500- 72% remaining: 0 days 0 hrs 3 min, step time = 607.7 ms
P000: 74% step 1284:H0214b22-23 Day +04 11:00 2008-01-05 11:30:00: Rel.:378000: Active:378000 M:340099 S:23868 B:14033 D:000 O:00 N:0 Buffer:378000- 72% remaining: 0 days 0 hrs 3 min, step time = 627.6 ms
P000: 75% step 1290:H0215b23-24 Day +04 11:30 2008-01-05 12:00:00: Rel.:378000: Active:378000 M:340340 S:23944 B:13716 D:000 O:00 N:0 Buffer:378000- 72% remaining: 0 days 0 hrs 3 min, step time = 608.0 ms
P000: 75% step 1296:H0216b24-25 Day +04 12:00 2008-01-05 12:30:00: Rel.:381500: Active:381500 M:343556 S:24596 B:13348 D:000 O:00 N:0 Buffer:381500- 73% remaining: 0 days 0 hrs 2 min, step time = 631.6 ms
P000: 75% step 1302:H0217b25-26 Day +04 12:30 2008-01-05 13:00:00: Rel.:381500: Active:381500 M:343918 S:24614 B:12968 D:000 O:00 N:0 Buffer:381500- 73% remaining: 0 days 0 hrs 2 min, step time = 620.7 ms
P000: 76% step 1308:H0218b26-27 Day +04 13:00 2008-01-05 13:30:00: Rel.:385000: Active:385000 M:346969 S:25346 B:12685 D:000 O:00 N:0 Buffer:385000- 74% remaining: 0 days 0 hrs 2 min, step time = 615.9 ms
P000: 76% step 1314:H0219b27-28 Day +04 13:30 2008-01-05 14:00:00: Rel.:385000: Active:385000 M:347033 S:25354 B:12613 D:000 O:00 N:0 Buffer:385000- 74% remaining: 0 days 0 hrs 2 min, step time = 616.5 ms
P000: 76% step 1320:H0220b28-29 Day +04 14:00 2008-01-05 14:30:00: Rel.:388500: Active:388500 M:349930 S:25851 B:12719 D:000 O:00 N:0 Buffer:388500- 74% remaining: 0 days 0 hrs 2 min, step time = 622.1 ms
P000: 77% step 1326:H0221b29-30 Day +04 14:30 2008-01-05 15:00:00: Rel.:388500: Active:388500 M:350208 S:25612 B:12680 D:000 O:00 N:0 Buffer:388500- 74% remaining: 0 days 0 hrs 2 min, step time = 618.8 ms
P000: 77% step 1332:H0222b30-31 Day +04 15:00 2008-01-05 15:30:00: Rel.:392000: Active:392000 M:353442 S:26084 B:12474 D:000 O:00 N:0 Buffer:392000- 75% remaining: 0 days 0 hrs 2 min, step time = 656.0 ms
P000: 77% step 1338:H0223b31-32 Day +04 15:30 2008-01-05 16:00:00: Rel.:392000: Active:392000 M:353661 S:26031 B:12308 D:000 O:00 N:0 Buffer:392000- 75% remaining: 0 days 0 hrs 2 min, step time = 628.5 ms
P000: 78% step 1344:H0224b32-33 Day +04 16:00 2008-01-05 16:30:00: Rel.:395500: Active:395500 M:359113 S:21897 B:14490 D:000 O:00 N:0 Buffer:395500- 76% remaining: 0 days 0 hrs 2 min, step time = 642.8 ms
P000: 78% step 1350:H0225b33-34 Day +04 16:30 2008-01-05 17:00:00: Rel.:395500: Active:395500 M:361970 S:16360 B:17170 D:000 O:00 N:0 Buffer:395500- 76% remaining: 0 days 0 hrs 2 min, step time = 646.9 ms
P000: 78% step 1356:H0226b34-35 Day +04 17:00 2008-01-05 17:30:00: Rel.:399000: Active:399000 M:366998 S:13958 B:18044 D:000 O:00 N:0 Buffer:399000- 76% remaining: 0 days 0 hrs 2 min, step time = 660.7 ms
P000: 79% step 1362:H0227b35-36 Day +04 17:30 2008-01-05 18:00:00: Rel.:399000: Active:399000 M:371215 S:07459 B:20326 D:000 O:00 N:0 Buffer:399000- 76% remaining: 0 days 0 hrs 2 min, step time = 662.6 ms
P000: 79% step 1368:H0228b36-37 Day +04 18:00 2008-01-05 18:30:00: Rel.:402500: Active:402500 M:375996 S:05426 B:21078 D:000 O:00 N:0 Buffer:402500- 77% remaining: 0 days 0 hrs 2 min, step time = 704.8 ms
P000: 80% step 1374:H0229b37-38 Day +04 18:30 2008-01-05 19:00:00: Rel.:402500: Active:402500 M:377009 S:03845 B:21646 D:000 O:00 N:0 Buffer:402500- 77% remaining: 0 days 0 hrs 2 min, step time = 676.1 ms
P000: 80% step 1380:H0230b38-39 Day +04 19:00 2008-01-05 19:30:00: Rel.:406000: Active:406000 M:382170 S:00666 B:23164 D:000 O:00 N:0 Buffer:406000- 78% remaining: 0 days 0 hrs 2 min, step time = 694.4 ms
P000: 80% step 1386:H0231b39-40 Day +04 19:30 2008-01-05 20:00:00: Rel.:406000: Active:406000 M:382720 S:00072 B:23208 D:000 O:00 N:0 Buffer:406000- 78% remaining: 0 days 0 hrs 2 min, step time = 684.5 ms
P000: 81% step 1392:H0232b40-41 Day +04 20:00 2008-01-05 20:30:00: Rel.:409500: Active:409500 M:385535 S:00072 B:23893 D:000 O:00 N:0 Buffer:409500- 78% remaining: 0 days 0 hrs 2 min, step time = 695.8 ms
P000: 81% step 1398:H0233b41-42 Day +04 20:30 2008-01-05 21:00:00: Rel.:409500: Active:409500 M:385630 S:00523 B:23347 D:000 O:00 N:0 Buffer:409500- 78% remaining: 0 days 0 hrs 2 min, step time = 688.6 ms
P000: 81% step 1404:H0234b42-43 Day +04 21:00 2008-01-05 21:30:00: Rel.:413000: Active:413000 M:384709 S:08946 B:19345 D:000 O:00 N:0 Buffer:413000- 79% remaining: 0 days 0 hrs 2 min, step time = 710.5 ms
P000:   - Reading-file-05  schism_marl20080105_00z_3D.nc, steps in file  48, steps  available 192:239, reading   5 of 48 steps,  for hydo-model time steps 235:239,  from file offsets 43:47,  into ring buffer offsets 043:047 
P000:   - Reading-file-06  schism_marl20080106_00z_3D.nc, steps in file  48, steps  available 240:287, reading  43 of 43 steps,  for hydo-model time steps 240:282,  from file offsets 00:42,  into ring buffer offsets 000:042 
P000:       -  read  48 time steps in  22.1 sec
P000: 82% step 1410:H0235b43-44 Day +04 21:30 2008-01-05 22:00:00: Rel.:413000: Active:413000 M:383759 S:10710 B:18531 D:000 O:00 N:0 Buffer:413000- 79% remaining: 0 days 0 hrs 2 min, step time = 22736.3 ms
P000: 82% step 1416:H0236b44-45 Day +04 22:00 2008-01-05 22:30:00: Rel.:416500: Active:416500 M:386085 S:12320 B:18095 D:000 O:00 N:0 Buffer:416500- 80% remaining: 0 days 0 hrs 2 min, step time = 693.2 ms
P000: 82% step 1422:H0237b45-46 Day +04 22:30 2008-01-05 23:00:00: Rel.:416500: Active:416500 M:383926 S:16505 B:16069 D:000 O:00 N:0 Buffer:416500- 80% remaining: 0 days 0 hrs 2 min, step time = 679.7 ms
P000: 83% step 1428:H0238b46-47 Day +04 23:00 2008-01-05 23:30:00: Rel.:420000: Active:420000 M:383796 S:20759 B:15445 D:000 O:00 N:0 Buffer:420000- 80% remaining: 0 days 0 hrs 2 min, step time = 685.9 ms
P000: 83% step 1434:H0239b47-00 Day +04 23:30 2008-01-06 00:00:00: Rel.:420000: Active:420000 M:381834 S:23309 B:14857 D:000 O:00 N:0 Buffer:420000- 80% remaining: 0 days 0 hrs 2 min, step time = 679.0 ms
P000: 83% step 1440:H0240b00-01 Day +05 00:00 2008-01-06 00:30:00: Rel.:423500: Active:423500 M:381237 S:29435 B:12828 D:000 O:00 N:0 Buffer:423500- 81% remaining: 0 days 0 hrs 2 min, step time = 699.2 ms
P000: 84% step 1446:H0241b01-02 Day +05 00:30 2008-01-06 01:00:00: Rel.:423500: Active:423500 M:380711 S:29504 B:13285 D:000 O:00 N:0 Buffer:423500- 81% remaining: 0 days 0 hrs 2 min, step time = 672.8 ms
P000: 84% step 1452:H0242b02-03 Day +05 01:00 2008-01-06 01:30:00: Rel.:427000: Active:427000 M:382951 S:30365 B:13684 D:000 O:00 N:0 Buffer:427000- 82% remaining: 0 days 0 hrs 2 min, step time = 682.0 ms
P000: 84% step 1458:H0243b03-04 Day +05 01:30 2008-01-06 02:00:00: Rel.:427000: Active:427000 M:383093 S:30376 B:13531 D:000 O:00 N:0 Buffer:427000- 82% remaining: 0 days 0 hrs 2 min, step time = 677.5 ms
P000: 85% step 1464:H0244b04-05 Day +05 02:00 2008-01-06 02:30:00: Rel.:430500: Active:430500 M:386041 S:30876 B:13583 D:000 O:00 N:0 Buffer:430500- 82% remaining: 0 days 0 hrs 2 min, step time = 686.8 ms
P000: 85% step 1470:H0245b05-06 Day +05 02:30 2008-01-06 03:00:00: Rel.:430500: Active:430500 M:386188 S:30870 B:13442 D:000 O:00 N:0 Buffer:430500- 82% remaining: 0 days 0 hrs 1 min, step time = 685.5 ms
P000: 85% step 1476:H0246b06-07 Day +05 03:00 2008-01-06 03:30:00: Rel.:434000: Active:434000 M:389217 S:31355 B:13428 D:000 O:00 N:0 Buffer:434000- 83% remaining: 0 days 0 hrs 1 min, step time = 714.0 ms
P000: 86% step 1482:H0247b07-08 Day +05 03:30 2008-01-06 04:00:00: Rel.:434000: Active:434000 M:389505 S:31289 B:13206 D:000 O:00 N:0 Buffer:434000- 83% remaining: 0 days 0 hrs 1 min, step time = 692.3 ms
P000: 86% step 1488:H0248b08-09 Day +05 04:00 2008-01-06 04:30:00: Rel.:437500: Active:437500 M:394754 S:27171 B:15575 D:000 O:00 N:0 Buffer:437500- 84% remaining: 0 days 0 hrs 1 min, step time = 709.3 ms
P000: 86% step 1494:H0249b09-10 Day +05 04:30 2008-01-06 05:00:00: Rel.:437500: Active:437500 M:396235 S:24483 B:16782 D:000 O:00 N:0 Buffer:437500- 84% remaining: 0 days 0 hrs 1 min, step time = 705.4 ms
P000: 87% step 1500:H0250b10-11 Day +05 05:00 2008-01-06 05:30:00: Rel.:441000: Active:441000 M:401860 S:19984 B:19156 D:000 O:00 N:0 Buffer:441000- 84% remaining: 0 days 0 hrs 1 min, step time = 726.8 ms
P000: 87% step 1506:H0251b11-12 Day +05 05:30 2008-01-06 06:00:00: Rel.:441000: Active:441000 M:404665 S:15464 B:20871 D:000 O:00 N:0 Buffer:441000- 84% remaining: 0 days 0 hrs 1 min, step time = 726.7 ms
P000: 88% step 1512:H0252b12-13 Day +05 06:00 2008-01-06 06:30:00: Rel.:444500: Active:444500 M:410221 S:12321 B:21958 D:000 O:00 N:0 Buffer:444500- 85% remaining: 0 days 0 hrs 1 min, step time = 755.3 ms
P000: 88% step 1518:H0253b13-14 Day +05 06:30 2008-01-06 07:00:00: Rel.:444500: Active:444500 M:411568 S:10543 B:22389 D:000 O:00 N:0 Buffer:444500- 85% remaining: 0 days 0 hrs 1 min, step time = 737.2 ms
P000: 88% step 1524:H0254b14-15 Day +05 07:00 2008-01-06 07:30:00: Rel.:448000: Active:448000 M:416562 S:06564 B:24874 D:000 O:00 N:0 Buffer:448000- 86% remaining: 0 days 0 hrs 1 min, step time = 755.7 ms
P000: 89% step 1530:H0255b15-16 Day +05 07:30 2008-01-06 08:00:00: Rel.:448000: Active:448000 M:420505 S:00523 B:26972 D:000 O:00 N:0 Buffer:448000- 86% remaining: 0 days 0 hrs 1 min, step time = 748.8 ms
P000: 89% step 1536:H0256b16-17 Day +05 08:00 2008-01-06 08:30:00: Rel.:451500: Active:451500 M:423467 S:00072 B:27961 D:000 O:00 N:0 Buffer:451500- 86% remaining: 0 days 0 hrs 1 min, step time = 766.1 ms
P000: 89% step 1542:H0257b17-18 Day +05 08:30 2008-01-06 09:00:00: Rel.:451500: Active:451500 M:423567 S:00531 B:27402 D:000 O:00 N:0 Buffer:451500- 86% remaining: 0 days 0 hrs 1 min, step time = 760.8 ms
P000: 90% step 1548:H0258b18-19 Day +05 09:00 2008-01-06 09:30:00: Rel.:455000: Active:455000 M:421202 S:11847 B:21951 D:000 O:00 N:0 Buffer:455000- 87% remaining: 0 days 0 hrs 1 min, step time = 774.3 ms
P000: 90% step 1554:H0259b19-20 Day +05 09:30 2008-01-06 10:00:00: Rel.:455000: Active:455000 M:421166 S:12987 B:20847 D:000 O:00 N:0 Buffer:455000- 87% remaining: 0 days 0 hrs 1 min, step time = 749.9 ms
P000: 90% step 1560:H0260b20-21 Day +05 10:00 2008-01-06 10:30:00: Rel.:458500: Active:458500 M:420759 S:19559 B:18182 D:000 O:00 N:0 Buffer:458500- 88% remaining: 0 days 0 hrs 1 min, step time = 753.2 ms
P000: 91% step 1566:H0261b21-22 Day +05 10:30 2008-01-06 11:00:00: Rel.:458500: Active:458500 M:419608 S:21233 B:17659 D:000 O:00 N:0 Buffer:458500- 88% remaining: 0 days 0 hrs 1 min, step time = 750.5 ms
P000: 91% step 1572:H0262b22-23 Day +05 11:00 2008-01-06 11:30:00: Rel.:462000: Active:462000 M:419897 S:25418 B:16685 D:000 O:00 N:0 Buffer:462000- 88% remaining: 0 days 0 hrs 1 min, step time = 751.0 ms
P000: 91% step 1578:H0263b23-24 Day +05 11:30 2008-01-06 12:00:00: Rel.:462000: Active:462000 M:418126 S:28158 B:15716 D:000 O:00 N:0 Buffer:462000- 88% remaining: 0 days 0 hrs 1 min, step time = 738.7 ms
P000: 92% step 1584:H0264b24-25 Day +05 12:00 2008-01-06 12:30:00: Rel.:465500: Active:465500 M:418673 S:33432 B:13395 D:000 O:00 N:0 Buffer:465500- 89% remaining: 0 days 0 hrs 1 min, step time = 760.2 ms
P000: 92% step 1590:H0265b25-26 Day +05 12:30 2008-01-06 13:00:00: Rel.:465500: Active:465500 M:419032 S:33549 B:12919 D:000 O:00 N:0 Buffer:465500- 89% remaining: 0 days 0 hrs 1 min, step time = 735.5 ms
P000: 92% step 1596:H0266b26-27 Day +05 13:00 2008-01-06 13:30:00: Rel.:469000: Active:469000 M:421481 S:35264 B:12255 D:000 O:00 N:0 Buffer:469000- 90% remaining: 0 days 0 hrs 1 min, step time = 742.2 ms
P000: 93% step 1602:H0267b27-28 Day +05 13:30 2008-01-06 14:00:00: Rel.:469000: Active:469000 M:419755 S:37344 B:11901 D:000 O:00 N:0 Buffer:469000- 90% remaining: 0 days 0 hrs 1 min, step time = 737.0 ms
P000: 93% step 1608:H0268b28-29 Day +05 14:00 2008-01-06 14:30:00: Rel.:472500: Active:472500 M:422704 S:37844 B:11952 D:000 O:00 N:0 Buffer:472500- 90% remaining: 0 days 0 hrs 0 min, step time = 750.2 ms
P000: 93% step 1614:H0269b29-30 Day +05 14:30 2008-01-06 15:00:00: Rel.:472500: Active:472500 M:422534 S:37844 B:12122 D:000 O:00 N:0 Buffer:472500- 90% remaining: 0 days 0 hrs 0 min, step time = 741.0 ms
P000: 94% step 1620:H0270b30-31 Day +05 15:00 2008-01-06 15:30:00: Rel.:476000: Active:476000 M:426468 S:36271 B:13261 D:000 O:00 N:0 Buffer:476000- 91% remaining: 0 days 0 hrs 0 min, step time = 774.2 ms
P000: 94% step 1626:H0271b31-32 Day +05 15:30 2008-01-06 16:00:00: Rel.:476000: Active:476000 M:427276 S:35058 B:13666 D:000 O:00 N:0 Buffer:476000- 91% remaining: 0 days 0 hrs 0 min, step time = 752.6 ms
P000: 94% step 1632:H0272b32-33 Day +05 16:00 2008-01-06 16:30:00: Rel.:479500: Active:479500 M:430322 S:35527 B:13651 D:000 O:00 N:0 Buffer:479500- 92% remaining: 0 days 0 hrs 0 min, step time = 763.1 ms
P000: 95% step 1638:H0273b33-34 Day +05 16:30 2008-01-06 17:00:00: Rel.:479500: Active:479500 M:430831 S:35470 B:13199 D:000 O:00 N:0 Buffer:479500- 92% remaining: 0 days 0 hrs 0 min, step time = 761.7 ms
P000: 95% step 1644:H0274b34-35 Day +05 17:00 2008-01-06 17:30:00: Rel.:483000: Active:483000 M:436895 S:29274 B:16831 D:000 O:00 N:0 Buffer:483000- 92% remaining: 0 days 0 hrs 0 min, step time = 779.0 ms
P000: 95% step 1650:H0275b35-36 Day +05 17:30 2008-01-06 18:00:00: Rel.:483000: Active:483000 M:439948 S:24233 B:18819 D:000 O:00 N:0 Buffer:483000- 92% remaining: 0 days 0 hrs 0 min, step time = 779.5 ms
P000: 96% step 1656:H0276b36-37 Day +05 18:00 2008-01-06 18:30:00: Rel.:486500: Active:486500 M:446010 S:19588 B:20902 D:000 O:00 N:0 Buffer:486500- 93% remaining: 0 days 0 hrs 0 min, step time = 815.3 ms
P000: 96% step 1662:H0277b37-38 Day +05 18:30 2008-01-06 19:00:00: Rel.:486500: Active:486500 M:450761 S:12990 B:22749 D:000 O:00 N:0 Buffer:486500- 93% remaining: 0 days 0 hrs 0 min, step time = 809.4 ms
P000: 97% step 1668:H0278b38-39 Day +05 19:00 2008-01-06 19:30:00: Rel.:490000: Active:490000 M:454895 S:11845 B:23260 D:000 O:00 N:0 Buffer:490000- 94% remaining: 0 days 0 hrs 0 min, step time = 812.5 ms
P000: 97% step 1674:H0279b39-40 Day +05 19:30 2008-01-06 20:00:00: Rel.:490000: Active:490000 M:462859 S:00072 B:27069 D:000 O:00 N:0 Buffer:490000- 94% remaining: 0 days 0 hrs 0 min, step time = 823.9 ms
P000: 97% step 1680:H0280b40-41 Day +05 20:00 2008-01-06 20:30:00: Rel.:493500: Active:493500 M:467328 S:00000 B:26172 D:000 O:00 N:0 Buffer:493500- 94% remaining: 0 days 0 hrs 0 min, step time = 837.3 ms
P000: 98% step 1686:H0281b41-42 Day +05 20:30 2008-01-06 21:00:00: Rel.:493500: Active:493500 M:463759 S:00000 B:29741 D:000 O:00 N:0 Buffer:493500- 94% remaining: 0 days 0 hrs 0 min, step time = 822.4 ms
P000:   - Reading-file-06  schism_marl20080106_00z_3D.nc, steps in file  48, steps  available 240:287, reading   6 of 48 steps,  for hydo-model time steps 282:287,  from file offsets 42:47,  into ring buffer offsets 042:047 
P000:   - Reading-file-07  schism_marl20080107_00z_3D.nc, steps in file  48, steps  available 288:335, reading  42 of 42 steps,  for hydo-model time steps 288:329,  from file offsets 00:41,  into ring buffer offsets 000:041 
P000:       -  read  48 time steps in  21.8 sec
P000: 98% step 1692:H0282b42-43 Day +05 21:00 2008-01-06 21:30:00: Rel.:497000: Active:497000 M:468776 S:00000 B:28224 D:000 O:00 N:0 Buffer:497000- 95% remaining: 0 days 0 hrs 0 min, step time = 22703.7 ms
P000: 98% step 1698:H0283b43-44 Day +05 21:30 2008-01-06 22:00:00: Rel.:497000: Active:497000 M:460345 S:15970 B:20685 D:000 O:00 N:0 Buffer:497000- 95% remaining: 0 days 0 hrs 0 min, step time = 817.6 ms
P000: 99% step 1704:H0284b44-45 Day +05 22:00 2008-01-06 22:30:00: Rel.:500500: Active:500500 M:463630 S:16357 B:20513 D:000 O:00 N:0 Buffer:500500- 96% remaining: 0 days 0 hrs 0 min, step time = 827.3 ms
P000: 99% step 1710:H0285b45-46 Day +05 22:30 2008-01-06 23:00:00: Rel.:500500: Active:500500 M:461529 S:19555 B:19416 D:000 O:00 N:0 Buffer:500500- 96% remaining: 0 days 0 hrs 0 min, step time = 820.1 ms
P000: 99% step 1716:H0286b46-47 Day +05 23:00 2008-01-06 23:30:00: Rel.:504000: Active:504000 M:461780 S:23442 B:18778 D:000 O:00 N:0 Buffer:504000- 96% remaining: 0 days 0 hrs 0 min, step time = 825.3 ms
P000: 100% step 1722:H0287b47-00 Day +05 23:30 2008-01-07 00:00:00: Rel.:504000: Active:504000 M:456505 S:29999 B:17496 D:000 O:00 N:0 Buffer:504000- 96% remaining: 0 days 0 hrs 0 min, step time = 809.2 ms
P000: 100% step 1727:H0287b47-00 Day +05 23:55 2008-01-07 00:25:00: Rel.:504000: Active:504000 M:464280 S:31538 B:08182 D:000 O:00 N:0 Buffer:504000- 96% remaining: 0 days 0 hrs 0 min, step time = 1018.4 ms
P000: >>> Note: Running in debug mode
P000: >>> Note: When use aged binned particle stats, to get un biases stats., need to stop releasing particles "max_age_to_bin"  or max("user_age_bin_edges")  before end of run, by setting  particle param "release_duration"
P000: >>> Note: When use aged binned particle stats, to get un biases stats., need to stop releasing particles "max_age_to_bin"  or max("user_age_bin_edges")  before end of run, by setting  particle param "release_duration"
P000: >>> Note: No open boundaries requested, as run_params["open_boundary_type"] = 0
P000:       Hint: Requires list of open boundary nodes not in hydro model, eg for Schism this can be read from hgrid file to named in reader params and run_params["open_boundary_type"] = 1
P000: --------------------------------------------------------------------------
P000:   - Finished case number   0,  Sounds started: 2023-05-06 20:00:42.434469, ended: 2023-05-06 20:15:40.206259
P000:       Elapsed time =0:14:57.771790
P000: --------------------------------------------------------------------------
M: --------------------------------------------------------------------------
M:   - Finished -  started: 2023-05-06 20:00:42.421964- ended: 2023-05-06 20:15:40.253300
M:       Elapsed time =0:14:57.831336
M:         Output in F:\OceanTrackerOuput\OceanTrackerProfiling\Sounds
M: --------------------------------------------------------------------------
Profile results in  results\line_profiler\Sounds\AMD64_Family_23_Model_49_Stepping_0__AuthenticAMD\PItest_001Sounds_CodeVer_0.4.00.003_2023-04-27
Done
Wrote profile results to profileOT.py.lprof
Timer unit: 1e-07 s

Total time: 188.644 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\field_group_manager\field_group_manager.py
Function: interp_named_field_at_particle_locations at line 37

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    37                                               @function_profiler(__name__)
    38                                               def interp_named_field_at_particle_locations(self, fieldName, active, output=None):
    39                                                   # interp reader fieldName inplace to particle locations to same time and memory
    40                                                   # output can optionally be redirected to another particle property name different from  reader's fieldName
    41                                                   # particle_prop_name
    42                                           
    43     24188     156902.0      6.5      0.0          si = self.shared_info
    44     24188      94555.0      3.9      0.0          if output is None:
    45                                                       # over write current values
    46     17280     374000.0     21.6      0.0              output = si.classes['particle_properties'][fieldName].used_buffer()
    47                                           
    48     24188 1885810290.0  77964.7    100.0          si.classes['interpolator'].interp_field_at_particle_locations(fieldName, active, output)

Total time: 1.11738 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: initial_setup at line 33

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    33                                               @function_profiler(__name__)
    34                                               def initial_setup(self):
    35         1         62.0     62.0      0.0          super().initial_setup()  # children must call this parent class to default shared_params etc
    36         1         17.0     17.0      0.0          params = self.params
    37         1         12.0     12.0      0.0          si= self.shared_info
    38         1         29.0     29.0      0.0          grid = si.classes['reader'].grid
    39         1         14.0     14.0      0.0          grid_time_buffers = si.classes['reader'].grid_time_buffers
    40                                           
    41                                                   # make barcentric transform matrix for the grid,  typee to match numba signature
    42         1   10760274.0 10760274.0     96.3          grid['bc_transform'] = triangle_interpolator_util.get_BC_transform_matrix(grid['x'].data, grid['triangles'].data).astype(np.float64)
    43                                           
    44                                                   # build kd tree for initial triangle find node nearest node locations
    45                                                   #todo delete xy_centriod = np.mean(grid['x'][grid['triangles']], axis=1)
    46                                                   #todo deleteself.KDtree = cKDTree(xy_centriod)
    47         1     371688.0 371688.0      3.3          self.KDtree = cKDTree(grid['x'])
    48                                           
    49                                                   # create particle properties to  store history of current triangle  for reuse
    50                                           
    51         1         40.0     40.0      0.0          p = si.classes['particle_group_manager']
    52         2       6842.0   3421.0      0.1          p.create_particle_property('manual_update',dict(name='n_cell',  write=False, dtype=np.int32,
    53         1          8.0      8.0      0.0                                     initial_value=0))  # start with cell number guess of zero
    54         1      17394.0  17394.0      0.2          p.create_particle_property('manual_update',dict(name='bc_cords',  write=False, initial_value=0., vector_dim=3,dtype=np.float64))
    55                                           
    56                                                   # BC walk info
    57                                                   # build cell walk info dtype
    58         1         59.0     59.0      0.0          self.walk_counts = np.zeros((5,),dtype=np.int64)
    59         1         19.0     19.0      0.0          self.info['walk_info'] = {'particles_killed_after_triangle_walk_retry_failed': 0,'triangle_walks_retried':0}
    60                                           
    61         1         14.0     14.0      0.0          if si.hydro_model_is3D:
    62                                                       # space to record vertical cell for each particles' triangle at two timer steps  for each node in cell containing particle
    63                                                       # used to do 3D time dependent interpolation
    64         1       5896.0   5896.0      0.1              p.create_particle_property('manual_update',dict(name='nz_cell',  write=False, dtype=np.int32, initial_value=grid_time_buffers['zlevel'].shape[2]-2)) # todo  create  initial serach for vertical cell
    65         1       5661.0   5661.0      0.1              p.create_particle_property('manual_update',dict(name='z_fraction',   write=False, dtype=np.float32, initial_value=0.))
    66         1       5789.0   5789.0      0.1              p.create_particle_property('manual_update', dict(name='z_fraction_bottom_layer', write=False, dtype=np.float32, initial_value=0., description=' thickness of bottom layer in metres, used for log layer velocity interp in bottom layer'))

Total time: 444.709 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: setup_interp_time_step at line 71

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    71                                               @function_profiler(__name__)
    72                                               def setup_interp_time_step(self, time_sec, xq, active):
    73                                                   # set up stuff needed by all fields before any 2D interpolation
    74                                                   # eg query point and nt the current global time step, from which we are making nt+1
    75     10364      94912.0      9.2      0.0          si =self.shared_info
    76     10364      72987.0      7.0      0.0          info = self.info
    77     10364      66816.0      6.4      0.0          reader = si.classes['reader']
    78                                                   # ger buffer index from this time and next
    79                                           
    80     10364    2674133.0    258.0      0.1          nt_hindcast_step = reader.time_to_hydro_model_index(time_sec)
    81     10364     406269.0     39.2      0.0          info['current_buffer_index'][0] = reader.hydro_model_index_to_buffer_offset(nt_hindcast_step)
    82     10364     183086.0     17.7      0.0          info['current_buffer_index'][1] = reader.hydro_model_index_to_buffer_offset(nt_hindcast_step + si.model_direction) # buffer is forward in timenext index could be wrapped in ring buffer
    83     10364      66821.0      6.4      0.0          info['current_hydro_model_step'] = nt_hindcast_step
    84                                           
    85     10364      54203.0      5.2      0.0          grid_time_buffers = reader.grid_time_buffers
    86                                           
    87     10364     186539.0     18.0      0.0          time_hindcast =   grid_time_buffers['time'][info['current_buffer_index'][0]]
    88                                           
    89     10364     180401.0     17.4      0.0          info['current_step_dt_fraction'] = abs(time_sec - time_hindcast) / reader.info['hydro_model_time_step']
    90                                           
    91                                                   # update 0-255 dry cell index
    92     10364   60507658.0   5838.3      1.4          eval_interp.update_dry_cell_index(info['current_buffer_index'], info['current_step_dt_fraction'], grid_time_buffers['is_dry_cell'],   grid_time_buffers['dry_cell_index'])
    93                                           
    94                                                   # find cell for xq, node list and weight for interp at calls
    95     10364 4382597468.0 422867.4     98.5          self.find_cell(xq, info['current_buffer_index'], info['current_step_dt_fraction'], active)

Total time: 188.442 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: interp_field_at_particle_locations at line 97

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    97                                               @function_profiler(__name__)
    98                                               def interp_field_at_particle_locations(self, fieldName, active, output):
    99                                                   # interp reader fieldName inplace to particle locations to same time and memory
   100                                                   # output can optionally be redirected to another particle property name different from  reader's fieldName
   101                                                   # particle_prop_name
   102                                           
   103     24188     141378.0      5.8      0.0          si = self.shared_info
   104     24188     100044.0      4.1      0.0          info= self.info
   105     48376 1883879595.0  38942.4    100.0          si.classes['interpolator'].eval_field_interpolation_at_particle_locations(
   106     24188     197314.0      8.2      0.0              si.classes['fields'][fieldName], info['current_buffer_index'],
   107     24188      97414.0      4.0      0.0              output, active, step_dt_fraction=info['current_step_dt_fraction'])

Total time: 0 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: interp_named_field_at_given_locations_and_time at line 109

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   109                                               @function_profiler(__name__)
   110                                               def interp_named_field_at_given_locations_and_time(self, fieldName, x, time=None, n_cell=None, output=None):
   111                                                   # interp reader fieldName at specfied locations,  not particle locations
   112                                                   # output can optionally be redirected to another particle property name different from  reader's fieldName
   113                                                   # particle_prop_name
   114                                                   si = self.shared_info
   115                                                   output = si.classes['interpolator'].eval_field_interpolation_at_given_locations(si.classes['fields'][fieldName], x, time, output=output, n_cell=n_cell)
   116                                           
   117                                                   return output

Total time: 438.182 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: find_cell at line 119

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   119                                               @function_profiler(__name__)
   120                                               def find_cell(self, xq, nb,step_dt_fraction, active):
   121                                                   # locate cell in place
   122                                                   # nt give but not needed in 2D
   123     10364      66762.0      6.4      0.0          si= self.shared_info
   124     10364  610874038.0  58941.9     13.9          self.find_horizontal_cell(xq, active)  # best method!
   125                                           
   126     10364      56290.0      5.4      0.0          if si.hydro_model_is3D:
   127     10364 3770819223.0 363838.2     86.1              self.find_vertical_cell( xq,nb,step_dt_fraction, active)

Total time: 60.9055 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: find_horizontal_cell at line 129

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   129                                               @function_profiler(__name__)
   130                                               def find_horizontal_cell(self,xq, active):
   131                                                   # Bary Centric walk, flags land triangles in numba code
   132     10364     106307.0     10.3      0.0          si = self.shared_info
   133     10364      89468.0      8.6      0.0          info = self.info
   134                                           
   135     10364      89677.0      8.7      0.0          wi = info['walk_info']
   136     10364      87714.0      8.5      0.0          part_prop = si.classes['particle_properties']
   137     10364  579954317.0  55958.5     95.2          self.locate_BCwalk(xq, active)
   138                                                   # transphere count info
   139     10364     751873.0     72.5      0.1          wi['particles_located_by_walking'],wi['number_of_triangles_walked'],\
   140     20728     458362.0     22.1      0.1                  wi['longest_triangle_walk'], wi['nans_encountered_triangle_walk'] = self.walk_counts[:4]
   141                                           
   142     10364   27357480.0   2639.7      4.5          sel = part_prop['status'].find_subset_where(active, 'eq', si.particle_status_flags['cell_search_failed'], out =self.get_particle_subset_buffer())
   143                                           
   144     10364     160286.0     15.5      0.0          if sel.size > 0:
   145                                                       wi['triangle_walks_retried'] += sel.size
   146                                           
   147                                                       new_cell  = self.initial_cell_guess(xq[sel,:])
   148                                                       part_prop['n_cell'].set_values(new_cell, sel)
   149                                                       self.locate_BCwalk(xq, sel)
   150                                           
   151                                                       sel = part_prop['status'].find_subset_where(sel, 'eq', si.particle_status_flags['cell_search_failed'], out=self.get_particle_subset_buffer())
   152                                                       if sel.size > 0:
   153                                                           wi['particles_killed_after_triangle_walk_retry_failed'] += sel.size # total failed walks
   154                                                           si.msg_logger.msg('walks too long after kd retry- killed ' + str(sel.shape[0]) + ' particles',warning=True,tabs=0,
   155                                                                             hint='Try decreasing time step or increasing interpolator parameter "max_search_steps", current value =' + str(self.params['max_search_steps']))
   156                                                           # make notes for log file enabling follow up
   157                                                           si.msg_logger.msg('particle locations of failed walks, first 3 or less ', warning=True,tabs=2)
   158                                                           si.msg_logger.msg(' location xq =' + str(xq[sel[:3], :].tolist()), warning=True,tabs=2)
   159                                                           si.msg_logger.msg(' x_old =' + str(part_prop['x_last_good'].data[sel[:3], :].tolist()),warning=True,tabs=2)
   160                                                           # kill particles
   161                                                           part_prop['status'].set_values(si.particle_status_flags['dead'], sel)

Total time: 376.888 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: find_vertical_cell at line 182

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   182                                               @function_profiler(__name__)
   183                                               def find_vertical_cell(self,xq,nb,step_dt_fraction, active):
   184     10364      99016.0      9.6      0.0          si = self.shared_info
   185     10364      68478.0      6.6      0.0          reader = si.classes['reader']
   186     10364      79996.0      7.7      0.0          grid = reader.grid
   187                                           
   188     10364      59697.0      5.8      0.0          part_prop = si.classes['particle_properties']
   189     10364      94097.0      9.1      0.0          n_cell = part_prop['n_cell'].data
   190     10364     109434.0     10.6      0.0          z_fraction = part_prop['z_fraction'].data
   191     10364      91887.0      8.9      0.0          z_fraction_bottom_layer =  part_prop['z_fraction_bottom_layer'].data
   192     10364      59316.0      5.7      0.0          status = part_prop['status'].data
   193     10364      74843.0      7.2      0.0          BCcord     = part_prop['bc_cords'].data
   194     10364      89575.0      8.6      0.0          nz_cell = part_prop['nz_cell'].data
   195     10364      55555.0      5.4      0.0          grid_time_buffers = reader.grid_time_buffers
   196                                           
   197     20728 3766748333.0 181722.7     99.9          triangle_interpolator_util.get_depth_cell_time_varying_Slayer_or_LSCgrid(
   198     10364     118249.0     11.4      0.0                          grid_time_buffers['zlevel'],   grid['triangles'], grid['bottom_cell_index'],   si.z0,
   199     10364      69234.0      6.7      0.0                          xq, n_cell, nb, status, BCcord, nz_cell, z_fraction, z_fraction_bottom_layer, active, self.walk_counts, step_dt_fraction)
   200                                           
   201                                                   # unpack counts
   202     10364     253203.0     24.4      0.0          wi = self.info['walk_info']
   203     10364     804546.0     77.6      0.0          wi['total_vertical_steps'], wi['longest_vertical_walk'] = self.walk_counts[3:]

Total time: 1.98769 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: initial_cell_guess at line 205

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   205                                               @function_profiler(__name__)
   206                                               def initial_cell_guess(self, xq):
   207                                                   # find nearest cell
   208       432       3461.0      8.0      0.0          si=self.shared_info
   209       432       2829.0      6.5      0.0          grid = si.classes['reader'].grid
   210       432       2366.0      5.5      0.0          grid_time_buffers = si.classes['reader'].grid_time_buffers
   211                                           
   212                                                    # find nearest node
   213       432    3885651.0   8994.6     19.5          dist, nodes = self.KDtree.query(xq[:, :2])
   214       432      19523.0     45.2      0.1          nodes = nodes.astype(np.int32)  # KD tree gives int64,need for compatibility of types
   215                                           
   216                                                   # look in triangles attached to each node for tri containing the point
   217       864   15928955.0  18436.3     80.1          n_cell= triangle_interpolator_util.check_if_point_inside_triangle_connected_to_node(xq, nodes,
   218       432       4806.0     11.1      0.0                                       grid['node_to_tri_map'], grid['tri_per_node'],  grid['bc_transform'], self.params['bc_walk_tol'])
   219                                                   # if x is nan dist is infinite
   220       432      27225.0     63.0      0.1          n_cell[~np.isfinite(dist)] = -1
   221                                           
   222       432       2088.0      4.8      0.0          return n_cell

Total time: 187.985 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: eval_field_interpolation_at_particle_locations at line 230

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   230                                               @function_profiler(__name__)
   231                                               def eval_field_interpolation_at_particle_locations(self, fieldObj, nb  , output, active, step_dt_fraction=None):
   232                                                   # in place evaluation of field interpolation
   233     24188     198004.0      8.2      0.0          si = self.shared_info
   234     24188     187437.0      7.7      0.0          grid = si.classes['reader'].grid
   235     24188     133482.0      5.5      0.0          part_prop= si.classes['particle_properties']
   236     24188     177992.0      7.4      0.0          n_cell   = part_prop['n_cell'].data
   237     24188     149897.0      6.2      0.0          bc_cords = part_prop['bc_cords'].data
   238                                           
   239     24188     702207.0     29.0      0.0          if fieldObj.is_time_varying():
   240     20732     321617.0     15.5      0.0              if fieldObj.is3D():
   241     13820      95678.0      6.9      0.0                  nz_cell = part_prop['nz_cell'].data
   242     13820      82754.0      6.0      0.0                  nz_bottom = grid['bottom_cell_index']
   243     13820      86921.0      6.3      0.0                  z_fraction = part_prop['z_fraction'].data
   244                                           
   245     13820     117615.0      8.5      0.0                  if fieldObj.params['name']=='water_velocity':
   246                                                               # 3D vel needs log layer interp in bottom cell
   247     10364      76457.0      7.4      0.0                      z_fraction_bottom_layer = part_prop['z_fraction_bottom_layer'].data
   248                                           
   249     20728 1470950100.0  70964.4     78.2                      eval_interp.eval_water_velocity_3D(basic_util.atLeast_Nby1(output),
   250     10364      52707.0      5.1      0.0                                                         fieldObj.data,
   251     10364      45613.0      4.4      0.0                                                         nb,
   252     10364      44603.0      4.3      0.0                                                         step_dt_fraction,
   253     10364      50040.0      4.8      0.0                                                         grid['triangles'],
   254     10364      44333.0      4.3      0.0                                                         n_cell,
   255     10364      44087.0      4.3      0.0                                                         nz_cell,
   256     10364      43904.0      4.2      0.0                                                         nz_bottom,
   257     10364      48037.0      4.6      0.0                                                         z_fraction,
   258     10364      52644.0      5.1      0.0                                                      z_fraction_bottom_layer,
   259     10364      49959.0      4.8      0.0                                                         bc_cords,     active)
   260                                                           else:
   261      6912  177105732.0  25622.9      9.4                      eval_interp.time_dependent_3Dfield(basic_util.atLeast_Nby1(output),
   262      3456      20871.0      6.0      0.0                                                         fieldObj.data,
   263      3456      15884.0      4.6      0.0                                                         nb,
   264      3456      15404.0      4.5      0.0                                                         step_dt_fraction,
   265      3456      17498.0      5.1      0.0                                                         grid['triangles'],
   266      3456      16951.0      4.9      0.0                                                         n_cell, nz_cell,nz_bottom,
   267      3456      15878.0      4.6      0.0                                                         z_fraction, bc_cords, active)
   268                                                               #F_out, F_data, nb, step_dt_fraction, tri, nz_bottom, n_cell, nz_cell, z_fraction, BCcord, active
   269                                                       else:
   270     13824  157104713.0  11364.6      8.4                  eval_interp.time_dependent_2Dfield(basic_util.atLeast_Nby1(output),
   271      6912      40870.0      5.9      0.0                                                     fieldObj.data,
   272      6912      31585.0      4.6      0.0                                                     nb,
   273      6912      30971.0      4.5      0.0                                                     step_dt_fraction,
   274      6912      36062.0      5.2      0.0                                                     grid['triangles'],
   275      6912      30436.0      4.4      0.0                                                     n_cell,
   276      6912      31405.0      4.5      0.0                                                     bc_cords, active)
   277                                                   else:
   278                                                       # 2D or 3D non-time varying
   279      3456      47653.0     13.8      0.0              if fieldObj.is3D():
   280                                                           # todo eval_interp3D_timeIndependent not implented for 3D non-time varying fields
   281                                                           nz_cell = part_prop['nz_cell'].data
   282                                                           z_fraction_nodes = part_prop['z_fraction_nodes'].data
   283                                                           raise Exception('eval_field_interpolation_at_particle_locations : spatial interp using eval_interp3D_timeIndependent not implemented yet ')
   284                                                       else:
   285      6912   71463598.0  10339.1      3.8                  eval_interp.time_independent_2Dfield(basic_util.atLeast_Nby1(output),
   286      3456      19252.0      5.6      0.0                                                       fieldObj.data,
   287      3456      19313.0      5.6      0.0                                                       grid['triangles'],
   288      3456      15544.0      4.5      0.0                                                       n_cell,
   289      3456      15825.0      4.6      0.0                                                       bc_cords, active)

Total time: 0 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\interp_triangle_native_grid.py
Function: eval_field_interpolation_at_given_locations at line 291

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   291                                               @function_profiler(__name__)
   292                                               def eval_field_interpolation_at_given_locations(self, fieldObj,x, time=None,  output=None, n_cell= None):
   293                                                   # in  evaluation of field interpolation at specific locations, ie not particle locations
   294                                                   #todo not working - eval_field_interpolation_at_given_locations
   295                                           
   296                                                   si = self.shared_info
   297                                                   grid = si.classes['reader'].grid
   298                                                   grid_time_buffers = si.classes['reader'].grid_time_buffers
   299                                                   part_prop= si.classes['particle_properties']
   300                                                   reader = si.classes['reader']
   301                                           
   302                                                   # is no output name give particle property for output is same as hindcast fieldName
   303                                                   if output is None:
   304                                                       if  fieldObj.data.shape[3]> 1:
   305                                                           output= np.full((x.shape[0], fieldObj.data.shape[3]), np.nan)
   306                                                       else:
   307                                                           output = np.full((x.shape[0],),np.nan)
   308                                           
   309                                                   if n_cell is None:
   310                                                       n_cell= self.initial_cell_guess(x)
   311                                           
   312                                                   # get bc cords for the cells
   313                                                   bc_cords = self.get_bc_cords(x, n_cell)
   314                                                   active = np.arange(x.shape[0])
   315                                           
   316                                                   if fieldObj.is_time_varying():
   317                                                       # get buffer time step and time fraction
   318                                                       nt = reader.time_to_hydro_model_index(time)
   319                                                       nb = reader.buffer_index_to_buffer_offset(nt)
   320                                                       step_dt_fraction = abs(time - reader.get_particle_time(nb)) / si.hydo_model_time_step
   321                                           
   322                                                       if fieldObj.is3D():
   323                                                           z_fraction_nodes = part_prop['z_fraction_nodes'].data
   324                                                           nz_nodes = part_prop['nz_cell'].data
   325                                           
   326                                                           if fieldObj.params['name']=='water_velocity':
   327                                                               # 3D vel needs log layer interp in bottom cell
   328                                                               eval_interp.eval_water_velocity_3D(basic_util.atLeast_Nby1(output),
   329                                                                                                  fieldObj.data,
   330                                                                                                  nb,
   331                                                                                                  step_dt_fraction,
   332                                                                                                  grid['triangles'],
   333                                                                                                  n_cell,
   334                                                                                                  nz_nodes, z_fraction_nodes, bc_cords,
   335                                                                                                  grid_time_buffers['zlevel'], grid['bottom_cell_index'],
   336                                                                                                  active)
   337                                                           else:
   338                                                               eval_interp.time_dependent_3Dfield(basic_util.atLeast_Nby1(output),
   339                                                                                                  fieldObj.get_data(nt_buffer=nb),
   340                                                                                                  fieldObj.get_data(nt_buffer=nb + 1),
   341                                                                                                  step_dt_fraction,
   342                                                                                                  grid['triangles'],
   343                                                                                                  n_cell,
   344                                                                                                  nz_nodes, z_fraction_nodes, bc_cords, active)
   345                                                       else:
   346                                                           # todo 2D time dep not not working yet
   347                                                           eval_interp.time_dependent_2Dfield(basic_util.atLeast_Nby1(output),
   348                                                                                              fieldObj.data,
   349                                                                                              nb,
   350                                                                                              step_dt_fraction,
   351                                                                                              grid['triangles'],
   352                                                                                              n_cell,
   353                                                                                              bc_cords, active)
   354                                                   else:
   355                                                       # 2D or 3D non-time varying
   356                                                       if fieldObj.is3D():
   357                                                           # todo eval_interp3D_timeIndependent not implemented for 3D non-time varying fields
   358                                                           nz_nodes = part_prop['nz_cell'].data
   359                                                           z_fraction_nodes = part_prop['z_fraction_nodes'].data
   360                                                           raise Exception('eval_field_interpolation_at_given_locations: spatial interp using eval_interp3D_timeIndependent not implemented yet ')
   361                                                       else:
   362                                                           # is working
   363                                                           eval_interp.time_independent_2Dfield(basic_util.atLeast_Nby1(output),
   364                                                                                                fieldObj.data,
   365                                                                                                grid['triangles'],
   366                                                                                                n_cell,
   367                                                                                                bc_cords, active)
   368                                                           return  output

Total time: 0 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\util\eval_interp.py
Function: time_dependent_3Dfield at line 71

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    71                                           @function_profiler(__name__)
    72                                           @njit()
    73                                           def time_dependent_3Dfield(F_out, F_data, nb, step_dt_fraction, tri,  n_cell, nz_cell, nz_bottom, z_fraction, BCcord,  active):
    74                                               #  time dependent 3D linear interpolation in place, ie write directly to F_out for isActive particles
    75                                           
    76                                               n_comp = F_data.shape[3]  # time step of data is always [nb, node,z,comp] even in 2D
    77                                           
    78                                               # create views to remove redundant dim at current and next time step, improves speed?
    79                                               F1 = F_data[nb[0]  , :, :, :]
    80                                               F2 = F_data[nb[1], :, :, :]
    81                                           
    82                                               dt1 = 1.0 - step_dt_fraction
    83                                           
    84                                           
    85                                               # loop over active particles and vector components
    86                                               for n in active:
    87                                                   for i in range(n_comp): F_out[n, i] = 0. # zero out for summing
    88                                                   zf = z_fraction[n]
    89                                                   zf1 = 1. - zf
    90                                           
    91                                                   nodes = tri[n_cell[n],:]
    92                                                   nz = nz_cell[n]
    93                                           
    94                                           
    95                                                   # loop over each vertex in triangle
    96                                                   for m in range(3):
    97                                                       n_node = nodes[m]
    98                                           
    99                                                       # for LSC grid need to get highest node of nz or bottom at each triangle vertex
   100                                                       nzb = nz_bottom[n_node]  # bottom node at this vertex
   101                                                       nz_below = max(nzb, nz    )
   102                                                       nz_above = max(nzb, nz + 1)
   103                                                       # loop over vector components
   104                                                       for c in range(n_comp):
   105                                                           # add contributions from layer above and below particle, for each spatial component at two time steps
   106                                                           F_out[n, c] +=     BCcord[n, m] * (F1[n_node, nz_below, c] * zf1 + F1[n_node, nz_above, c] * zf)*dt1  \
   107                                                                           +  BCcord[n, m] * (F2[n_node, nz_below, c] * zf1 + F2[n_node, nz_above, c] * zf)*step_dt_fraction  # second time step

Total time: 0 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\interpolator\util\eval_interp.py
Function: eval_water_velocity_3D at line 109

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   109                                           @function_profiler(__name__)
   110                                           @njit( ( (float64[:,:], float32[:, :, :, :],int32[:],float64,
   111                                                               int32[:,:],int32[:], int32[:], int32[:],
   112                                                               float32[:], float32[:], float64[:,:], int32[:] )))
   113                                           def eval_water_velocity_3D(V_out, V_data, nb, step_dt_fraction,
   114                                                                      tri, n_cell,nz_cell, nz_bottom,
   115                                                                      z_fraction,z_fraction_bottom_layer,  BCcord,  active):
   116                                               #  special case of interpolating water velocity with log layer in bottom cell, linear z interpolation at other depth cells
   117                                           
   118                                               n_comp = V_data.shape[3]  # time step of data is always [node,z,comp] even in 2D
   119                                           
   120                                               # create views to remove redundant dim at current and next time step, improves speed?
   121                                               v1,     v2 = V_data[nb[0] , :, :, :], V_data[nb[1], :, :, :]
   122                                           
   123                                               dt1= 1.0-step_dt_fraction
   124                                           
   125                                               # loop over active particles and vector components
   126                                               for n in active:
   127                                                   for i in range(n_comp): V_out[n, i] = 0. # zero out for summing
   128                                           
   129                                                   nz = nz_cell[n]
   130                                           
   131                                           
   132                                                   # if in bottom cell adjust fraction to larger value to give log layer interp
   133                                                   # first time step z_fraction[n, 10, m]
   134                                                   if z_fraction_bottom_layer[n] >= 0 :
   135                                                       zf = z_fraction_bottom_layer[n]
   136                                                   else:
   137                                                       # fraction =-00 is not on the bottom
   138                                                       zf = z_fraction[n]
   139                                           
   140                                                   zf1 = 1.0 - zf
   141                                           
   142                                                   # loop over each vertex in triangle
   143                                                   for m in range(3):
   144                                                       n_node = tri[n_cell[n], m]
   145                                           
   146                                                       # for LSC grid need to get highest node of nz or bottom at each triangle vertex
   147                                                       nzb = nz_bottom[n_node]  # bottom node at this vertex
   148                                                       nz_below = max(nzb, nz    )
   149                                                       nz_above = max(nzb, nz + 1)
   150                                                       # loop over vector components
   151                                                       #print('eval',v1[n_node, nz_below, :] , v1[n_node, nz_above, :])
   152                                                       for c in range(n_comp):
   153                                                           # add contributions from layer above and below particle, for each spatial component at two time steps
   154                                                           V_out[n, c] +=  BCcord[n, m] * (v1[n_node, nz_below, c] * zf1 + v1[n_node, nz_above, c] * zf) * dt1 \
   155                                                                        +  BCcord[n, m] * (v2[n_node, nz_below, c] * zf1 + v2[n_node, nz_above, c] * zf) * step_dt_fraction  # second time step
   156                                                           pass

Total time: 13.0315 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\particle_group_manager\particle_group_manager.py
Function: release_particles at line 63

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    63                                               @function_profiler(__name__)
    64                                               def release_particles(self, time_sec):
    65                                                   # see if any group is ready to release
    66      1728      21844.0     12.6      0.0          si = self.shared_info
    67      1728     275929.0    159.7      0.2          new_buffer_indices = np.full((0,), 0, np.int32)
    68                                           
    69      5184      77663.0     15.0      0.1          for g in si.classes['particle_release_groups'].values():
    70      3456      55577.0     16.1      0.0              ri = g.info['release_info']
    71      3456     306400.0     88.7      0.2              sel =  time_sec* si.model_direction >= ri['release_times'][ri['index_of_next_release']: ] * si.model_direction# any  puleses not release
    72      3456     195981.0     56.7      0.2              num_pulses= np.count_nonzero(sel)
    73      3744      58602.0     15.7      0.0              for n in range(num_pulses):
    74       288   41546266.0 144257.9     31.9                  x0, IDrelease_group, IDpulse, user_release_groupID, n_cell_guess = g.release_locations()
    75       288   24461049.0  84934.2     18.8                  new_index = self.release_a_particle_group_pulse(time_sec, x0, IDrelease_group, IDpulse, user_release_groupID, n_cell_guess)
    76       288      21067.0     73.1      0.0                  new_buffer_indices = np.concatenate((new_buffer_indices,new_index),dtype=np.int32)
    77       288       3370.0     11.7      0.0                  ri['index_of_next_release'] += 1
    78                                           
    79                                                   # for all new particles update cell and bc cords for new particles all at same time
    80      1728      14471.0      8.4      0.0          part_prop = si.classes['particle_properties']
    81                                           
    82                                                   #todo does this setup_interp_time_step have to be here?
    83      1728   20474158.0  11848.5     15.7          si.classes['field_group_manager'].setup_time_step(time_sec, part_prop['x'].data, new_buffer_indices)  # new time is at end of sub step fraction =1
    84                                           
    85                                                   # initial values  part prop derived from fields
    86     50112     420476.0      8.4      0.3          for name, i  in si.classes['particle_properties'].items():
    87     48384     556354.0     11.5      0.4              if i.info['prop_type'] =='from_fields':
    88      8640     597752.0     69.2      0.5                  i.initial_value_at_birth(new_buffer_indices)
    89                                           
    90                                                   # give user/custom prop their initial values at birth, eg zero distance, these may require interp that is setup above
    91     50112     368262.0      7.3      0.3          for name, i  in si.classes['particle_properties'].items():
    92     48384     395643.0      8.2      0.3              if i.info['prop_type'] == 'user':
    93      3456     187030.0     54.1      0.1                  i.initial_value_at_birth(new_buffer_indices)
    94                                           
    95                                                   # update new particles props
    96                                                   # todo does this update_PartProp have to be here as setup_interp_time_step and update_PartProp are run immediately after this in pre step bookkeeping ?
    97      1728   36365342.0  21044.8     27.9          self.update_PartProp(time_sec, new_buffer_indices)
    98                                           
    99                                                   # flag if any bad initial locations
   100      1728      26012.0     15.1      0.0          if si.settings['open_boundary_type'] > 0:
   101                                                       bad = part_prop['status'].find_subset_where(new_buffer_indices, 'lt', si.particle_status_flags['outside_open_boundary'], out=self.get_particle_index_buffer())
   102                                                   else:
   103      1728    3851093.0   2228.6      3.0              bad = part_prop['status'].find_subset_where(new_buffer_indices, 'lt', si.particle_status_flags['frozen'], out=self.get_particle_index_buffer())
   104                                           
   105      1728      21888.0     12.7      0.0          if bad.shape[0] > 0:
   106                                                       si.msg_logger.msg(str(bad.shape[0]) + ' initial locations are outside grid domain, or NaN, or outside due to random selection of locations outside domain',warning=True)
   107                                                       si.msg_logger.msgg(' Status of bad initial locations' + str(part_prop['status'].get_values(bad)),warning=True)
   108      1728      12549.0      7.3      0.0          return new_buffer_indices #indices of all new particles

Total time: 83.4371 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\particle_group_manager\particle_group_manager.py
Function: update_PartProp at line 205

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   205                                               @function_profiler(__name__)
   206                                               def update_PartProp(self, t, active):
   207                                                   # updates particle properties which can be updated automatically. ie those derive from reader fields or custom prop. using .update() method
   208      3456      29271.0      8.5      0.0          si = self.shared_info
   209      3456     127219.0     36.8      0.0          si.classes['time_varying_info']['time'].set_values(t)
   210      3456      21550.0      6.2      0.0          part_prop =si.classes['particle_properties']
   211                                           
   212      3456      28993.0      8.4      0.0          self.screen_msg= ''
   213                                                   #  calculate age particle property = t-time_released
   214      6912    8251053.0   1193.7      1.0          particle_operations_util.set_value_and_add(part_prop['age'].used_buffer(), t,
   215      3456      62301.0     18.0      0.0                                                     part_prop['time_released'].used_buffer(), active, scale= -1.)
   216                                           
   217                                                   # first interpolate to give particle properties from reader derived  fields
   218    100224     653629.0      6.5      0.1          for key,i in si.classes['particle_properties'].items():
   219     96768     810061.0      8.4      0.1              if i.info['prop_type'] == 'from_fields':
   220     17280  723535158.0  41871.2     86.7                  si.classes['field_group_manager'].interp_named_field_at_particle_locations(key, active)
   221                                           
   222                                                   # user/custom particle prop are updated after reader based prop. , as reader prop.  may be need for their update
   223    100224     648331.0      6.5      0.1          for key, i in si.classes['particle_properties'].items():
   224     96768     774463.0      8.0      0.1              if i.info['prop_type'] == 'user':
   225      6912   99429224.0  14385.0     11.9                  i.update(active)

Total time: 202.09 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\solver\solver.py
Function: pre_step_bookkeeping at line 133

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   133                                               @function_profiler(__name__)
   134                                               def pre_step_bookkeeping(self, nt,time_sec):
   135      1728      29663.0     17.2      0.0          si = self.shared_info
   136      1728      17401.0     10.1      0.0          part_prop = si.classes['particle_properties']
   137      1728      13763.0      8.0      0.0          pgm = si.classes['particle_group_manager']
   138      1728      11981.0      6.9      0.0          fgm = si.classes['field_group_manager']
   139                                           
   140      1728      12679.0      7.3      0.0          info = self.info  # same as si.solver_info
   141                                           
   142      1728     238815.0    138.2      0.0          info['current_model_date'] = time_util.seconds_to_datetime64(time_sec)
   143      1728      13894.0      8.0      0.0          info['current_model_time_step'] = nt
   144      1728      12241.0      7.1      0.0          info['current_model_time'] = time_sec
   145                                           
   146                                                   # release particles
   147                                                   #todo remove setp interp from particle release as done just below??
   148      1728  132505941.0  76681.7      6.6          new_particleIDs = pgm.release_particles(time_sec)
   149      1728    7707900.0   4460.6      0.4          alive = part_prop['status'].compare_all_to_a_value('gteq', si.particle_status_flags['frozen'], out=self.get_particle_index_buffer())
   150      1728      29851.0     17.3      0.0          self.info['total_alive_particles'] += alive.shape[0]
   151                                                   
   152                                                   # modify status
   153      3456      39538.0     11.4      0.0          for name, i in si.classes['status_modifiers'].items():
   154      1728   12004645.0   6947.1      0.6              i.update(time_sec, alive)
   155                                           
   156      1728     105369.0     61.0      0.0          pgm.kill_old_particles(time_sec) # todo convert to status modifier
   157      1728    4093204.0   2368.8      0.2          if si.compact_mode: pgm.remove_dead_particles_from_memory()
   158                                           
   159                                                   # some may now have status dead so update
   160      1728    3941957.0   2281.2      0.2          alive = part_prop['status'].compare_all_to_a_value('gteq', si.particle_status_flags['frozen'], out=self.get_particle_index_buffer())
   161                                           
   162                                                   # trajectory modifiers,
   163      1728      24012.0     13.9      0.0          for name, i in si.classes['trajectory_modifiers'].items():
   164                                                       i.update(time_sec, alive)
   165                                           
   166      1728      12524.0      7.2      0.0          if si.hydro_model_is3D:
   167      1728   27273297.0  15783.2      1.3              si.classes['resuspension'].update(time_sec, alive)
   168                                           
   169      1728    3964292.0   2294.2      0.2          alive = part_prop['status'].compare_all_to_a_value('gteq', si.particle_status_flags['frozen'], out=self.get_particle_index_buffer())
   170                                           
   171                                                   # setup_interp_time_step
   172      1728  911335200.0 527393.1     45.1          fgm.setup_time_step(time_sec, part_prop['x'].data, alive)
   173                                           
   174                                                   # update particle properties
   175      1728  800490117.0 463246.6     39.6          pgm.update_PartProp(time_sec, alive)
   176                                           
   177                                                   # update writable class lists and stats at current time step now props are up to date
   178      1728   35856384.0  20750.2      1.8          self._update_stats(time_sec)
   179      1728      53183.0     30.8      0.0          self._update_concentrations(time_sec)
   180      1728   81091258.0  46927.8      4.0          self._update_events(time_sec)
   181                                           
   182                                                   # write tracks
   183      1728      23980.0     13.9      0.0          if si.write_tracks:
   184                                                       tracks_writer = si.classes['tracks_writer']
   185                                                       tracks_writer.open_file_if_needed()
   186                                                       tracks_writer.write_all_non_time_varing_part_properties(new_particleIDs)  # these must be written on release, to work in compact mode
   187                                           
   188                                                       # write tracks file
   189                                                       tracks_writer.write_all_time_varying_prop_and_data()

Total time: 497.732 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\solver\solver.py
Function: integration_step at line 192

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   192                                               @function_profiler(__name__)
   193                                               def integration_step(self, time_sec, is_moving):
   194                                                   # single step in particle tracking, t is time in seconds, is_moving are indcies of moving particles
   195                                                   # this is done inplace directly operation on the particle properties
   196                                                   # nb is buffer offset
   197      1727      28247.0     16.4      0.0          si = self.shared_info
   198      1727      21528.0     12.5      0.0          RK_order =self.params['RK_order']
   199      1727      17075.0      9.9      0.0          fgm = si.classes['field_group_manager']
   200      1727      15061.0      8.7      0.0          part_prop =  si.classes['particle_properties']
   201                                           
   202                                                   # note here subStep_time_step has sign of forwards/backwards
   203      1727      30107.0     17.4      0.0          dt = si.solver_info['model_time_step']*si.model_direction
   204      1727      16494.0      9.6      0.0          dt2=dt/2.
   205                                                   # set up views of  working variable space
   206      1727      21764.0     12.6      0.0          x1      = part_prop['x_last_good'].data
   207      1727      16112.0      9.3      0.0          x2      = part_prop['x'].data
   208      1727      17336.0     10.0      0.0          v       = part_prop['particle_velocity'].data
   209      1727      23918.0     13.8      0.0          v_temp  = part_prop['v_temp'].data  # temp vel from interp at each RK substeps
   210      1727      14711.0      8.5      0.0          velocity_modifier= part_prop['velocity_modifier'].data
   211                                           
   212                                                   # this makes x1, ['x_last_good']  at start of new integration step for moving particles, allowing updates to x2 ['x']
   213      1727   20604092.0  11930.6      0.4          particle_operations_util.copy(x1, x2, is_moving)
   214                                           
   215                                                   #  step 1 from current location and time
   216      1727  857011022.0 496242.6     17.2          fgm.setup_time_step(time_sec, x1, is_moving)
   217                                           
   218      1727      22013.0     12.7      0.0          if RK_order==1:
   219                                                       fgm.interp_named_field_at_particle_locations('water_velocity', is_moving, output=v)
   220                                                       solver_util.euler_substep( x1, v, velocity_modifier, dt, is_moving, x2)
   221                                                       return is_moving
   222                                           
   223                                                   # do first half step location from RK1 to update values
   224      1727  291123362.0 168571.7      5.8          fgm.interp_named_field_at_particle_locations('water_velocity', is_moving, output=v_temp)
   225      1727   49791594.0  28831.3      1.0          solver_util.euler_substep( x1, v_temp, velocity_modifier, dt2, is_moving, x2)
   226      1727   19278209.0  11162.8      0.4          particle_operations_util.copy(v, v_temp, is_moving, scale=1.0 / 6.0)   # accumulate RK velocity to reduce space taken by temporary working variables
   227                                           
   228                                                   # step 2, get improved half step velocity
   229      1727      79862.0     46.2      0.0          t2= time_sec + 0.5 * dt
   230      1727  903731610.0 523295.7     18.2          fgm.setup_time_step(t2, x2, is_moving)
   231                                           
   232      1727      21182.0     12.3      0.0          if RK_order==2:
   233                                                       fgm.interp_named_field_at_particle_locations('water_velocity', is_moving, output=v)
   234                                                       solver_util.euler_substep( x1, v, velocity_modifier, dt, is_moving, x2)
   235                                                       return is_moving
   236                                           
   237      1727  291109413.0 168563.6      5.8          fgm.interp_named_field_at_particle_locations('water_velocity', is_moving, output=v_temp)
   238      1727   49644289.0  28746.0      1.0          solver_util.euler_substep( x1, v_temp, velocity_modifier, dt2, is_moving, x2)
   239      1727   20647418.0  11955.7      0.4          particle_operations_util.add_to(v, v_temp, is_moving, scale=2.0 / 6.0)  # next accumulation of velocity step 2
   240                                           
   241                                                   # step 3, a second half step
   242      1727      82310.0     47.7      0.0          t2 = time_sec + 0.5 * dt
   243      1727  860726071.0 498393.8     17.3          fgm.setup_time_step(t2, x2, is_moving)
   244      1727  291058407.0 168534.1      5.8          fgm.interp_named_field_at_particle_locations('water_velocity', is_moving, output=v_temp)
   245      1727   49632573.0  28739.2      1.0          solver_util.euler_substep( x1, v_temp, velocity_modifier, dt, is_moving, x2)  # improve half step position values
   246      1727   17834091.0  10326.6      0.4          particle_operations_util.add_to(v, v_temp, is_moving, scale=2.0 / 6.0)  # next accumulation of velocity from step 3
   247                                           
   248                                                   # step 4, full step
   249      1727      74600.0     43.2      0.0          t2 = time_sec + dt
   250      1727  895857854.0 518736.5     18.0          fgm.setup_time_step(t2,  x2, is_moving)
   251      1727  291289301.0 168667.8      5.9          fgm.interp_named_field_at_particle_locations('water_velocity', is_moving, output=v_temp)
   252      1727   17768151.0  10288.4      0.4          particle_operations_util.add_to(v, v_temp, is_moving, scale=1.0 / 6.0)  # last accumulation of velocity for v4
   253                                           
   254                                                   # final location using  accumulation in "v"
   255                                                   # below is emulated by accumulation above of
   256                                                   #  v = (v1 + 2.0 * (v2 + v3) + v4) /6
   257                                                   #  x2 = x1 + v*dt
   258      1727   49713659.0  28786.1      1.0          solver_util.euler_substep( x1, v, velocity_modifier, dt, is_moving, x2)  # set final location directly to particle x property
   259                                           
   260                                                   #print('xxx', x2[:10, :] - x1[:10, :],v[:10,:])

Total time: 0 s
File: e:\onedrive - cawthron\h_local_drive\particletracking\oceantracker\oceantracker\tracks_writer\_base_tracks_writer.py
Function: write_all_time_varying_prop_and_data at line 149

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   149                                               @function_profiler(__name__)
   150                                               def write_all_time_varying_prop_and_data(self):
   151                                                   # write particle data at current time step, if none the a forced write
   152                                           
   153                                                   si= self.shared_info
   154                                           
   155                                                   if si.solver_info['time_steps_completed'] % self.info['output_step_count'] != 0: return
   156                                           
   157                                                   grid_time_buffers = si.classes['reader'].grid_time_buffers
   158                                           
   159                                                   # write time vary info , eg "time"
   160                                                   self.pre_time_step_write_book_keeping()
   161                                           
   162                                                   # write group data
   163                                                   for name,d in si.classes['time_varying_info'].items():
   164                                                       if d.params['write']:
   165                                                           self.write_time_varying_info(name, d)
   166                                           
   167                                                   for name,d in si.classes['particle_properties'].items():
   168                                                       if d.params['write'] and d.params['time_varying']:
   169                                                           self.write_time_varying_particle_prop(name, d.data)
   170                                           
   171                                                   if self.params['write_dry_cell_index']:
   172                                                       self.nc.file_handle.variables['dry_cell_index'][self.time_steps_written_to_current_file, : ] = grid_time_buffers['dry_cell_index'].reshape(1,-1)
   173                                           
   174                                                   self.time_steps_written_to_current_file +=1 # time steps in current file
   175                                                   self.total_time_steps_written  += 1 # time steps written since the start

